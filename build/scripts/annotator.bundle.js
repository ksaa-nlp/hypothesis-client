!function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(){function t(t){var e=!0,n=!1,i=null,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function r(t){return!!(t&&t!==document&&"HTML"!==t.nodeName&&"BODY"!==t.nodeName&&"classList"in t&&"contains"in t.classList)}function s(t){var e=t.type,n=t.tagName;return!("INPUT"!==n||!o[e]||t.readOnly)||"TEXTAREA"===n&&!t.readOnly||!!t.isContentEditable}function a(t){t.classList.contains("focus-visible")||(t.classList.add("focus-visible"),t.setAttribute("data-focus-visible-added",""))}function l(t){t.hasAttribute("data-focus-visible-added")&&(t.classList.remove("focus-visible"),t.removeAttribute("data-focus-visible-added"))}function c(n){n.metaKey||n.altKey||n.ctrlKey||(r(t.activeElement)&&a(t.activeElement),e=!0)}function h(t){e=!1}function u(t){
r(t.target)&&(e||s(t.target))&&a(t.target)}function d(t){r(t.target)&&(t.target.classList.contains("focus-visible")||t.target.hasAttribute("data-focus-visible-added"))&&(n=!0,window.clearTimeout(i),i=window.setTimeout((function(){n=!1}),100),l(t.target))}function f(t){"hidden"===document.visibilityState&&(n&&(e=!0),p())}function p(){document.addEventListener("mousemove",m),document.addEventListener("mousedown",m),document.addEventListener("mouseup",m),document.addEventListener("pointermove",m),document.addEventListener("pointerdown",m),document.addEventListener("pointerup",m),document.addEventListener("touchmove",m),document.addEventListener("touchstart",m),document.addEventListener("touchend",m)}function g(){document.removeEventListener("mousemove",m),document.removeEventListener("mousedown",m),document.removeEventListener("mouseup",m),document.removeEventListener("pointermove",m),document.removeEventListener("pointerdown",m),document.removeEventListener("pointerup",m),
document.removeEventListener("touchmove",m),document.removeEventListener("touchstart",m),document.removeEventListener("touchend",m)}function m(t){t.target.nodeName&&"html"===t.target.nodeName.toLowerCase()||(e=!1,g())}document.addEventListener("keydown",c,!0),document.addEventListener("mousedown",h,!0),document.addEventListener("pointerdown",h,!0),document.addEventListener("touchstart",h,!0),document.addEventListener("visibilitychange",f,!0),p(),t.addEventListener("focus",u,!0),t.addEventListener("blur",d,!0),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.host?t.host.setAttribute("data-js-focus-visible",""):t.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if("undefined"!=typeof window&&"undefined"!=typeof document){var e;window.applyFocusVisiblePolyfill=t;try{e=new CustomEvent("focus-visible-polyfill-ready")}catch(t){
(e=document.createEvent("CustomEvent")).initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(e)}"undefined"!=typeof document&&t(document)}();var e,n={exports:{}};e=n,function(){var t={}.hasOwnProperty;function n(){for(var e=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var r=typeof o;if("string"===r||"number"===r)e.push(o);else if(Array.isArray(o)){if(o.length){var s=n.apply(null,o);s&&e.push(s)}}else if("object"===r){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){e.push(o.toString());continue}for(var a in o)t.call(o,a)&&o[a]&&e.push(a)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}();var i,o,r,s,a,l,c=n.exports,h={},u=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function f(t,e){for(var n in e)t[n]=e[n];return t}function p(t){var e=t.parentNode;e&&e.removeChild(t)}function g(t,e,n,i,s){var a={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,
__h:null,constructor:void 0,__v:null==s?++r:s};return null==s&&null!=o.vnode&&o.vnode(a),a}function m(t){return t.children}function _(t,e){this.props=t,this.context=e}function v(t,e){if(null==e)return t.__?v(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?v(t):null}function y(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return y(t)}}function b(t){(!t.__d&&(t.__d=!0)&&s.push(t)&&!w.__r++||a!==o.debounceRendering)&&((a=o.debounceRendering)||setTimeout)(w)}function w(){for(var t;w.__r=s.length;)t=s.sort((function(t,e){return t.__v.__b-e.__v.__b})),s=[],t.some((function(t){var e,n,i,o,r,s;t.__d&&(r=(o=(e=t).__v).__e,(s=e.__P)&&(n=[],(i=f({},o)).__v=o.__v+1,T(s,o,i,e.__n,void 0!==s.ownerSVGElement,null!=o.__h?[r]:null,n,null==r?v(o):r,o.__h),R(n,o),o.__e!=r&&y(o)))}))}function C(t,e,n,i,o,r,s,a,l,c){
var d,f,p,_,y,b,w,C=i&&i.__k||u,E=C.length;for(n.__k=[],d=0;d<e.length;d++)if(null!=(_=n.__k[d]=null==(_=e[d])||"boolean"==typeof _?null:"string"==typeof _||"number"==typeof _||"bigint"==typeof _?g(null,_,null,null,_):Array.isArray(_)?g(m,{children:_},null,null,null):_.__b>0?g(_.type,_.props,_.key,_.ref?_.ref:null,_.__v):_)){if(_.__=n,_.__b=n.__b+1,null===(p=C[d])||p&&_.key==p.key&&_.type===p.type)C[d]=void 0;else for(f=0;f<E;f++){if((p=C[f])&&_.key==p.key&&_.type===p.type){C[f]=void 0;break}p=null}T(t,_,p=p||h,o,r,s,a,l,c),y=_.__e,(f=_.ref)&&p.ref!=f&&(w||(w=[]),p.ref&&w.push(p.ref,null,_),w.push(f,_.__c||y,_)),null!=y?(null==b&&(b=y),"function"==typeof _.type&&_.__k===p.__k?_.__d=l=x(_,l,t):l=S(t,_,p,C,y,l),"function"==typeof n.type&&(n.__d=l)):l&&p.__e==l&&l.parentNode!=t&&(l=v(p))}for(n.__e=b,d=E;d--;)null!=C[d]&&M(C[d],C[d]);if(w)for(d=0;d<w.length;d++)P(w[d],w[++d],w[++d])}function x(t,e,n){for(var i,o=t.__k,r=0;o&&r<o.length;r++)(i=o[r])&&(i.__=t,e="function"==typeof i.type?x(i,e,n):S(n,i,i,o,i.__e,e))
;return e}function S(t,e,n,i,o,r){var s,a,l;if(void 0!==e.__d)s=e.__d,e.__d=void 0;else if(null==n||o!=r||null==o.parentNode)t:if(null==r||r.parentNode!==t)t.appendChild(o),s=null;else{for(a=r,l=0;(a=a.nextSibling)&&l<i.length;l+=1)if(a==o)break t;t.insertBefore(o,r),s=r}return void 0!==s?s:o.nextSibling}function E(t,e,n){"-"===e[0]?t.setProperty(e,n):t[e]=null==n?"":"number"!=typeof n||d.test(e)?n:n+"px"}function k(t,e,n,i,o){var r;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof i&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||E(t.style,e,"");if(n)for(e in n)i&&n[e]===i[e]||E(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])r=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?i||t.addEventListener(e,r?A:N,r):t.removeEventListener(e,r?A:N,r);else if("dangerouslySetInnerHTML"!==e){
if(o)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null==n||!1===n&&-1==e.indexOf("-")?t.removeAttribute(e):t.setAttribute(e,n))}}function N(t){this.l[t.type+!1](o.event?o.event(t):t)}function A(t){this.l[t.type+!0](o.event?o.event(t):t)}function T(t,e,n,i,r,s,a,l,c){var h,u,d,p,g,v,y,b,w,x,S,E,k,N,A,T=e.type;if(void 0!==e.constructor)return null;null!=n.__h&&(c=n.__h,l=e.__e=n.__e,e.__h=null,s=[l]),(h=o.__b)&&h(e);try{t:if("function"==typeof T){if(b=e.props,w=(h=T.contextType)&&i[h.__c],x=h?w?w.props.value:h.__:i,n.__c?y=(u=e.__c=n.__c).__=u.__E:("prototype"in T&&T.prototype.render?e.__c=u=new T(b,x):(e.__c=u=new _(b,x),u.constructor=T,u.render=O),w&&w.sub(u),u.props=b,u.state||(u.state={}),u.context=x,u.__n=i,d=u.__d=!0,u.__h=[],u._sb=[]),null==u.__s&&(u.__s=u.state),null!=T.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=f({},u.__s)),
f(u.__s,T.getDerivedStateFromProps(b,u.__s))),p=u.props,g=u.state,d)null==T.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==T.getDerivedStateFromProps&&b!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(b,x),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(b,u.__s,x)||e.__v===n.__v){for(u.props=b,u.state=u.__s,e.__v!==n.__v&&(u.__d=!1),u.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach((function(t){t&&(t.__=e)})),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[],u.__h.length&&a.push(u);break t}null!=u.componentWillUpdate&&u.componentWillUpdate(b,u.__s,x),null!=u.componentDidUpdate&&u.__h.push((function(){u.componentDidUpdate(p,g,v)}))}if(u.context=x,u.props=b,u.__v=e,u.__P=t,E=o.__r,k=0,"prototype"in T&&T.prototype.render){for(u.state=u.__s,u.__d=!1,E&&E(e),h=u.render(u.props,u.state,u.context),N=0;N<u._sb.length;N++)u.__h.push(u._sb[N]);u._sb=[]}else do{u.__d=!1,E&&E(e),
h=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++k<25);u.state=u.__s,null!=u.getChildContext&&(i=f(f({},i),u.getChildContext())),d||null==u.getSnapshotBeforeUpdate||(v=u.getSnapshotBeforeUpdate(p,g)),A=null!=h&&h.type===m&&null==h.key?h.props.children:h,C(t,Array.isArray(A)?A:[A],e,n,i,r,s,a,l,c),u.base=e.__e,e.__h=null,u.__h.length&&a.push(u),y&&(u.__E=u.__=null),u.__e=!1}else null==s&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=L(n.__e,e,n,i,r,s,a,c);(h=o.diffed)&&h(e)}catch(t){e.__v=null,(c||null!=s)&&(e.__e=l,e.__h=!!c,s[s.indexOf(l)]=null),o.__e(t,e,n)}}function R(t,e){o.__c&&o.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){o.__e(t,e.__v)}}))}function L(t,e,n,o,r,s,a,l){var c,u,d,f=n.props,g=e.props,m=e.type,_=0;if("svg"===m&&(r=!0),null!=s)for(;_<s.length;_++)if((c=s[_])&&"setAttribute"in c==!!m&&(m?c.localName===m:3===c.nodeType)){t=c,s[_]=null;break}if(null==t){if(null===m)return document.createTextNode(g)
;t=r?document.createElementNS("http://www.w3.org/2000/svg",m):document.createElement(m,g.is&&g),s=null,l=!1}if(null===m)f===g||l&&t.data===g||(t.data=g);else{if(s=s&&i.call(t.childNodes),u=(f=n.props||h).dangerouslySetInnerHTML,d=g.dangerouslySetInnerHTML,!l){if(null!=s)for(f={},_=0;_<t.attributes.length;_++)f[t.attributes[_].name]=t.attributes[_].value;(d||u)&&(d&&(u&&d.__html==u.__html||d.__html===t.innerHTML)||(t.innerHTML=d&&d.__html||""))}if(function(t,e,n,i,o){var r;for(r in n)"children"===r||"key"===r||r in e||k(t,r,null,n[r],i);for(r in e)o&&"function"!=typeof e[r]||"children"===r||"key"===r||"value"===r||"checked"===r||n[r]===e[r]||k(t,r,e[r],n[r],i)}(t,g,f,r,l),d)e.__k=[];else if(_=e.props.children,C(t,Array.isArray(_)?_:[_],e,n,o,r&&"foreignObject"!==m,s,a,s?s[0]:n.__k&&v(n,0),l),null!=s)for(_=s.length;_--;)null!=s[_]&&p(s[_]);l||("value"in g&&void 0!==(_=g.value)&&(_!==t.value||"progress"===m&&!_||"option"===m&&_!==f.value)&&k(t,"value",_,f.value,!1),
"checked"in g&&void 0!==(_=g.checked)&&_!==t.checked&&k(t,"checked",_,f.checked,!1))}return t}function P(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){o.__e(t,n)}}function M(t,e,n){var i,r;if(o.unmount&&o.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||P(i,null,e)),null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(t){o.__e(t,e)}i.base=i.__P=null,t.__c=void 0}if(i=t.__k)for(r=0;r<i.length;r++)i[r]&&M(i[r],e,n||"function"!=typeof t.type);n||null==t.__e||p(t.__e),t.__=t.__e=t.__d=void 0}function O(t,e,n){return this.constructor(t,n)}function I(t,e,n){var r,s,a;o.__&&o.__(t,e),s=(r="function"==typeof n)?null:n&&n.__k||e.__k,a=[],T(e,t=(!r&&n||e).__k=function(t,e,n){var o,r,s,a={};for(s in e)"key"==s?o=e[s]:"ref"==s?r=e[s]:a[s]=e[s];if(arguments.length>2&&(a.children=arguments.length>3?i.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(s in t.defaultProps)void 0===a[s]&&(a[s]=t.defaultProps[s]);return g(t,a,o,r,null)
}(m,null,[t]),s||h,h,void 0!==e.ownerSVGElement,!r&&n?[n]:s?null:e.firstChild?i.call(e.childNodes):null,a,!r&&n?n:s?s.__e:e.firstChild,r),R(a,t)}function B(t,e){var n={__c:e="__cC"+l++,__:t,Consumer:function(t,e){return t.children(e)},Provider:function(t){var n,i;return this.getChildContext||(n=[],(i={})[e]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&n.some(b)},this.sub=function(t){n.push(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){n.splice(n.indexOf(t),1),e&&e.call(t)}}),t.children}};return n.Provider.__=n.Consumer.contextType=n}i=u.slice,o={__e:function(t,e,n,i){for(var o,r,s;e=e.__;)if((o=e.__c)&&!o.__)try{if((r=o.constructor)&&null!=r.getDerivedStateFromError&&(o.setState(r.getDerivedStateFromError(t)),s=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(t,i||{}),s=o.__d),s)return o.__E=o}catch(e){t=e}throw t}},r=0,_.prototype.setState=function(t,e){var n
;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=f({},this.state),"function"==typeof t&&(t=t(f({},n),this.props)),t&&f(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),b(this))},_.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),b(this))},_.prototype.render=m,s=[],w.__r=0,l=0;var F,H,D,V,q=0,U=[],z=[],$=o.__b,W=o.__r,j=o.diffed,X=o.__c,Y=o.unmount;function Z(t,e){o.__h&&o.__h(H,t,q||e),q=0;var n=H.__H||(H.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:z}),n.__[t]}function G(t){return q=1,function(t,e,n){var i=Z(F++,2);if(i.t=t,!i.__c&&(i.__=[n?n(e):at(void 0,e),function(t){var e=i.__N?i.__N[0]:i.__[0],n=i.t(e,t);e!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=H,!H.u)){H.u=!0;var o=H.shouldComponentUpdate;H.shouldComponentUpdate=function(t,e,n){if(!i.__c.__H)return!0;var r=i.__c.__H.__.filter((function(t){return t.__c}));if(r.every((function(t){return!t.__N})))return!o||o.call(this,t,e,n);var s=!1;return r.forEach((function(t){if(t.__N){var e=t.__[0]
;t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(s=!0)}})),!(!s&&i.__c.props===t)&&(!o||o.call(this,t,e,n))}}return i.__N||i.__}(at,t)}function K(t,e){var n=Z(F++,3);!o.__s&&st(n.__H,e)&&(n.__=t,n.i=e,H.__H.__h.push(n))}function Q(t,e){var n=Z(F++,4);!o.__s&&st(n.__H,e)&&(n.__=t,n.i=e,H.__h.push(n))}function J(t){return q=5,tt((function(){return{current:t}}),[])}function tt(t,e){var n=Z(F++,7);return st(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}function et(){for(var t;t=U.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(ot),t.__H.__h.forEach(rt),t.__H.__h=[]}catch(e){t.__H.__h=[],o.__e(e,t.__v)}}o.__b=function(t){H=null,$&&$(t)},o.__r=function(t){W&&W(t),F=0;var e=(H=t.__c).__H;e&&(D===H?(e.__h=[],H.__h=[],e.__.forEach((function(t){t.__N&&(t.__=t.__N),t.__V=z,t.__N=t.i=void 0}))):(e.__h.forEach(ot),e.__h.forEach(rt),e.__h=[])),D=H},o.diffed=function(t){j&&j(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==U.push(e)&&V===o.requestAnimationFrame||((V=o.requestAnimationFrame)||it)(et)),e.__H.__.forEach((function(t){
t.i&&(t.__H=t.i),t.__V!==z&&(t.__=t.__V),t.i=void 0,t.__V=z}))),D=H=null},o.__c=function(t,e){e.some((function(t){try{t.__h.forEach(ot),t.__h=t.__h.filter((function(t){return!t.__||rt(t)}))}catch(n){e.some((function(t){t.__h&&(t.__h=[])})),e=[],o.__e(n,t.__v)}})),X&&X(t,e)},o.unmount=function(t){Y&&Y(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach((function(t){try{ot(t)}catch(t){e=t}})),n.__H=void 0,e&&o.__e(e,n.__v))};var nt="function"==typeof requestAnimationFrame;function it(t){var e,n=function(){clearTimeout(i),nt&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,100);nt&&(e=requestAnimationFrame(n))}function ot(t){var e=H,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),H=e}function rt(t){var e=H;t.__c=t.__(),H=e}function st(t,e){return!t||t.length!==e.length||e.some((function(e,n){return e!==t[n]}))}function at(t,e){return"function"==typeof e?e(t):e}var lt=0;function ct(t,e,n,i,r){var s,a,l={};for(a in e)"ref"==a?s=e[a]:l[a]=e[a];var c={type:t,props:l,key:n,ref:s,__k:null,__:null,__b:0,__e:null,
__d:void 0,__c:null,__h:null,constructor:void 0,__v:--lt,__source:r,__self:i};if("function"==typeof t&&(s=t.defaultProps))for(a in s)void 0===l[a]&&(l[a]=s[a]);return o.vnode&&o.vnode(c),c}const ht=new Map;function ut({name:t,className:e="",inline:n=!1,title:i=""}){const o=ht.get(t);if(!o)throw new Error(`Icon "${t.toString()}" is not registered`);const r=J();Q((()=>{const t=r.current.querySelector("svg");t&&t.setAttribute("class",e)}),[e,o]);const s={};return i&&(s.title=i),ct("span",{className:c("Hyp-SvgIcon",{"Hyp-SvgIcon--inline":n}),dangerouslySetInnerHTML:{__html:o},ref:r,...s},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/SvgIcon.js",lineNumber:69,columnNumber:5})}function dt(t,e){const n="string"==typeof t?Symbol(t):t;return ht.set(n,e),n}var ft="/home/runner/work/frontend-shared/frontend-shared/src/components/buttons.js"
;function pt({buttonRef:t,classes:e,className:n,icon:i,iconPosition:o="left",size:r="medium",variant:s="normal",expanded:a,pressed:l,type:h="button",...u}){var d;const f=null!==(d=null==u?void 0:u.role)&&void 0!==d?d:"button",p={"aria-label":u.title};return"tab"===f?p["aria-selected"]=l:(p["aria-pressed"]=l,p["aria-expanded"]=a),ct("button",{ref:t,className:c(n,`${n}--${r}`,`${n}--${s}`,{[`${n}--icon-${o}`]:i},e),type:h,...p,...u},void 0,!1,{fileName:ft,lineNumber:84,columnNumber:5})}function gt({className:t="Hyp-IconButton",...e}){const{icon:n}=e;return ct(pt,{className:t,...e,children:ct(ut,{name:n},void 0,!1,{fileName:ft,lineNumber:112,columnNumber:7})},void 0,!1,{fileName:ft,lineNumber:111,columnNumber:5})}function mt({children:t,className:e="Hyp-LabeledButton",...n}){const{icon:i,iconPosition:o="left"}=n;return ct(pt,{className:e,...n,children:[i&&"left"===o&&ct(ut,{name:i},void 0,!1,{fileName:ft,lineNumber:131,columnNumber:43}),t,i&&"right"===o&&ct(ut,{name:i},void 0,!1,{fileName:ft,lineNumber:133,
columnNumber:44})]},void 0,!0,{fileName:ft,lineNumber:130,columnNumber:5})}dt("checkbox",'  <svg\n    width="16"\n    height="16"\n    viewBox="-4 -4 39 39"\n    aria-hidden="true"\n    focusable="false"\n  >\n    <rect\n      class="hyp-svg-checkbox--background"\n      width="35"\n      height="35"\n      x="-2"\n      y="-2"\n      stroke="currentColor"\n      fill="none"\n      stroke-width="3"\n      rx="5"\n      ry="5"\n    />\n    <polyline\n      class="hyp-svg-checkbox--checkmark"\n      points="4,14 12,23 28,5"\n      stroke="transparent"\n      stroke-width="5"\n      fill="none"\n    />\n</svg>')
;var _t='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8l3.536-3.536L8 8 4.464 4.464 8 8zm0 0l-3.536 3.536L8 8l3.536 3.536L8 8z"></path></g></svg>\n';dt("cancel",_t);function vt({name:t,classes:e="",containerClasses:n="",title:i=""}){const o=ht.get(t);if(!o)throw new Error(`Icon "${t.toString()}" is not registered`);const r=J();Q((()=>{const t=r.current.querySelector("svg");t&&t.setAttribute("class",c("Hyp-Icon",e))}),[e,o]);const s={};return i&&(s.title=i),ct("span",{className:n,dangerouslySetInnerHTML:{__html:o},ref:r,...s},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/Icon.js",lineNumber:62,columnNumber:5})}function yt({children:t,classes:e="",linkRef:n,...i}){return ct("a",{
className:c("Hyp-Link",e),ref:n,rel:"noopener noreferrer",...i,children:t},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/Link.js",lineNumber:26,columnNumber:5})}dt("cancel",_t)
;dt("spinner",'<svg viewBox="0 0 64 64" width="16" height="16">\n  <g stroke-width="6" stroke="currentColor" stroke-linecap="round">\n    <line y1="16" y2="28" transform="translate(32,32) rotate(180)">\n      <animate attributeName="stroke-opacity" dur="750ms" values="0;1;.8;.65;.45;.3;.15;0" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(225)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".15;0;1;.8;.65;.45;.3;.15" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(270)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".3;.15;0;1;.8;.65;.45;.3" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(315)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".45;.3;.15;0;1;.85;.65;.45" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(0)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".65;.45;.3;.15;0;1;.8;.65;" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(45)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".8;.65;.45;.3;.15;0;1;.8" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(90)">\n      <animate attributeName="stroke-opacity" dur="750ms" values="1;.85;.6;.45;.3;.15;0;1;" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(135)">\n      <animate attributeName="stroke-opacity" dur="750ms" values="0;1;.8;.65;.45;.3;.15;0" repeatCount="indefinite"></animate>\n    </line>\n  </g>\n</svg>')
;const bt={
annotate:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"/>\n</svg>\n',
cancel:_t,caution:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',"caret-left":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 12L6 8l4-4"></path></g></svg>',
"caret-right":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4l4 4-4 4"></path></g></svg>',
hide:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><path fill="currentColor" d="M1.61289944,0.209704612 L1.70710678,0.292893219 L15.7071068,14.2928932 C16.0976311,14.6834175 16.0976311,15.3165825 15.7071068,15.7071068 C15.3466228,16.0675907 14.7793918,16.0953203 14.3871006,15.7902954 L14.2928932,15.7071068 L0.292893219,1.70710678 C-0.0976310729,1.31658249 -0.0976310729,0.683417511 0.292893219,0.292893219 C0.65337718,-0.0675907428 1.22060824,-0.0953202783 1.61289944,0.209704612 Z M2.19604887,5.05494269 C2.65878442,5.35642943 2.78950241,5.97595401 2.48801567,6.43868956 C2.16488794,6.93464068 2,7.46139686 2,8 C2,10.1228856 4.62796016,12 8,12 C8.22060643,12 8.4396701,11.9919023 8.65660209,11.9758355 C9.20737829,11.9350431 9.68693944,12.3484666 9.72773191,12.8992428 C9.76852437,13.450019 9.35510087,13.9295801 8.80432467,13.9703726 C8.53822524,13.9900809 8.26988704,14 8,14 C3.64005335,14 0,11.3999619 0,8 C0,7.06308249 0.28281658,6.15958778 0.812302005,5.34690949 C1.11378875,4.88417394 1.73331332,4.75345595 2.19604887,5.05494269 Z M8,2 C12.3599467,2 16,4.6000381 16,8 C16,8.93691751 15.7171834,9.84041222 15.187698,10.6530905 C14.8862113,11.1158261 14.2666867,11.246544 13.8039511,10.9450573 C13.3412156,10.6435706 13.2104976,10.024046 13.5119843,9.56131044 C13.8351121,9.06535932 14,8.53860314 14,8 C14,5.8771144 11.3720398,4 8,4 C7.77939357,4 7.5603299,4.00809769 7.34339791,4.02416445 C6.79262171,4.06495692 6.31306056,3.65153342 6.27226809,3.10075722 C6.23147563,2.54998102 6.64489913,2.07041987 7.19567533,2.02962741 C7.46177476,2.00991913 7.73011296,2 8,2 Z"></path></svg>',
highlight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15H1h11zm-.5-6v2l-1 1v-2l1-1zm.5-7v6h-2V2h2zm0-1h-2 2zm0 8h-2 2z"></path></g></svg>',
note:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><path fill="currentColor" d="M14,0 C15.0543618,0 15.9181651,0.815877791 15.9945143,1.85073766 L16,2 L16,9 C16,9.27541264 15.8865388,9.53676152 15.6894833,9.7243131 L15.6,9.8 L7.6,15.8 C7.46152306,15.9038577 7.29908616,15.9695431 7.12886893,15.9916629 L7,16 L2,16 C0.945638205,16 0.0818348781,15.1841222 0.00548573643,14.1492623 L0,14 L0,2 C0,0.945638205 0.815877791,0.0818348781 1.85073766,0.00548573643 L2,0 L14,0 Z M14,2 L2,2 L2,14 L6,14 L6,9 C6,8.48716416 6.38604019,8.06449284 6.88337887,8.00672773 L7,8 L14,8 L14,2 Z M12,10 L8,10 L8,13 L12,10 Z"></path></svg>',pointer:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="8" viewBox="0 0 15 8" aria-hidden="true" focusable="false"><path d="M0 8 L7 0 L15 8" stroke="currentColor" strokeWidth="2" /></svg>\n',
show:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false"><path fill="currentColor" d="M8,2 C12.3599467,2 16,4.6000381 16,8 C16,11.3999619 12.3599467,14 8,14 C3.64005335,14 0,11.3999619 0,8 C0,4.6000381 3.64005335,2 8,2 Z M8,4 C4.62796016,4 2,5.8771144 2,8 C2,10.1228856 4.62796016,12 8,12 C11.3720398,12 14,10.1228856 14,8 C14,5.8771144 11.3720398,4 8,4 Z M8,6 C9.1045695,6 10,6.8954305 10,8 C10,9.1045695 9.1045695,10 8,10 C6.8954305,10 6,9.1045695 6,8 C6,6.8954305 6.8954305,6 8,6 Z"></path></svg>'};function wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Ct{constructor(){wt(this,"_listeners",void 0),this._listeners=new Map}add(t,e,n,i){t.addEventListener(e,n,i);const o=Symbol();return this._listeners.set(o,{eventTarget:t,eventType:e,listener:n}),o}remove(t){const e=this._listeners.get(t);if(e){const{eventTarget:n,eventType:i,listener:o}=e;n.removeEventListener(i,o),
this._listeners.delete(t)}}removeAll(){this._listeners.forEach((({eventTarget:t,eventType:e,listener:n})=>{t.removeEventListener(e,n)})),this._listeners.clear()}}function xt(t){const e=t.toString(16);return 1===e.length?"0"+e:e}function St(t){const e=new Uint8Array(t/2);return window.crypto.getRandomValues(e),Array.from(e).map(xt).join("")}function Et(t){if(null===t||"object"!=typeof t)return!1;for(let e of["frame1","frame2","type","requestId"])if("string"!=typeof t[e])return!1;return!0}function kt(t,e){return!!Et(t)&&JSON.stringify(t,Object.keys(e).sort())===JSON.stringify(e,Object.keys(e).sort())}class Nt{constructor({hostFrame:t,source:e,sourceId:n}){this._hostFrame=t,this._source=e,this._sourceId=n,this._listeners=new Ct}destroy(){this._listeners.removeAll()}async discover(t){let e=!1;if(("guest"===this._source&&"host"===t||"guest"===this._source&&"sidebar"===t||"sidebar"===this._source&&"host"===t||"notebook"===this._source&&"sidebar"===t)&&(e=!0),!e)throw new Error("Invalid request of channel/port")
;const n=St(6);return new Promise(((e,i)=>{const o=()=>{this._hostFrame.postMessage({frame1:this._source,frame2:t,type:"request",requestId:n,sourceId:this._sourceId},"*")},r=setInterval(o,250),s=setTimeout((()=>{clearInterval(r),i(new Error(`Unable to establish ${this._source}-${t} communication channel`))}),2e4),a=this._listeners.add(window,"message",(i=>{const{data:o,ports:l}=i;kt(o,{frame1:this._source,frame2:t,type:"offer",requestId:n})&&(clearInterval(r),clearTimeout(s),this._listeners.remove(a),e(l[0]))}));o()}))}}var At={exports:{}};function Tt(){}Tt.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function o(){i.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,o=n.length;i<o;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],o=[]
;if(i&&e)for(var r=0,s=i.length;r<s;r++)i[r].fn!==e&&i[r].fn._!==e&&o.push(i[r]);return o.length?n[t]=o:delete n[t],this}},At.exports=Tt;var Rt=At.exports.TinyEmitter=Tt;let Lt=null;function Pt(t){return t instanceof Error?{message:t.message,stack:t.stack}:{message:String(t),stack:void 0}}function Mt(t,e){if(!Lt)return;const n={type:"hypothesis-error",error:t instanceof Error?t:Pt(t),context:e};try{try{Lt.postMessage(n,"*")}catch(t){if(!(t instanceof DOMException&&"DataCloneError"===t.name))throw t;n.error=Pt(n.error),Lt.postMessage(n,"*")}}catch(t){console.warn("Unable to report Hypothesis error",t)}}function Ot(t){Lt=t}class It{constructor(t){this._hypothesisAppsOrigin=t,this._emitter=new Rt,this._handledRequests=new Set,this._sidebarHostChannel=new MessageChannel,this._listeners=new Ct,this._allowedMessages=[{allowedOrigin:"*",frame1:"guest",frame2:"host",type:"request"},{allowedOrigin:"*",frame1:"guest",frame2:"sidebar",type:"request"},{allowedOrigin:this._hypothesisAppsOrigin,frame1:"sidebar",
frame2:"host",type:"request"},{allowedOrigin:this._hypothesisAppsOrigin,frame1:"notebook",frame2:"sidebar",type:"request"}],this._listen()}_listen(){const t="Handling port request",e=new Set,n=n=>{e.has(n)||(e.add(n),Mt(new Error(n),t))};var i,o;this._listeners.add(window,"message",(i=t=>{const{data:e,origin:i,source:o}=t;if(!Et(e)||"request"!==e.type)return;const{frame1:r,frame2:s,requestId:a,sourceId:l}=e,c=`${r}-${s}`;if(!function(t){return!(null===t||t instanceof MessagePort||window.ServiceWorker&&t instanceof ServiceWorker)}(o))return void n(`Ignored port request for channel ${c} from non-Window source`);if(void 0===this._allowedMessages.find((({allowedOrigin:t,...n})=>this._messageMatches({allowedMessage:n,allowedOrigin:t,data:e,origin:i}))))return void n(`Ignored invalid port request for channel ${c} from ${i}`);if(this._handledRequests.has(a))return;this._handledRequests.add(a);const h="sidebar-host"===c?this._sidebarHostChannel:new MessageChannel,u={frame1:r,frame2:s,type:"offer",requestId:a,
sourceId:l},d="null"===i?"*":i;o.postMessage(u,d,[h.port1]),"sidebar"===s?this._sidebarHostChannel.port2.postMessage(u,[h.port2]):"host"===s&&this._emitter.emit("frameConnected",r,h.port2)},o=t,(...t)=>{try{return i(...t)}catch(t){throw Mt(t,o),t}}))}_messageMatches({allowedMessage:t,allowedOrigin:e,data:n,origin:i}){return("*"===e||i===e)&&kt(n,t)}on(t,e){this._emitter.on(t,e)}destroy(){this._listeners.removeAll()}}const Bt="1.0.0",Ft="frame-rpc";function Ht(t,e,n=[],i=-1){t.postMessage({protocol:Ft,version:Bt,arguments:n,method:e,sequence:i})}function Dt(t){const e=t.match(/\bAppleWebKit\/([0-9]+)\b/);if(!e)return!1;return!(parseInt(e[1])<=537)}class Vt{constructor({userAgent:t=navigator.userAgent,currentWindow:e=window}={}){this._port=null,this._methods=new Map,this._sequence=1,this._callbacks=new Map,this._listeners=new Ct,this._listeners.add(e,"unload",(()=>{this._port&&(Ht(this._port,"close"),e!==e.parent&&Dt(t)&&e.parent.postMessage({type:"hypothesisPortClosed"},"*",[this._port]))})),
this._pendingCalls=[],this._receivedCloseEvent=!1}on(t,e){if(this._port)throw new Error("Cannot add a method handler after a port is connected");this._methods.set(t,e)}connect(t){this._port=t,this._listeners.add(t,"message",(t=>this._handle(t))),t.start(),Ht(t,"connect");for(let[t,e]of this._pendingCalls)this.call(t,...e);this._pendingCalls=[]}destroy(){this._port&&(Ht(this._port,"close"),this._port.close()),this._destroyed=!0,this._listeners.removeAll()}call(t,...e){if(this._port||this._pendingCalls.push([t,e]),!this._port||this._destroyed)return;const n=this._sequence++,i=e[e.length-1];"function"==typeof i&&(this._callbacks.set(n,i),e=e.slice(0,-1)),Ht(this._port,t,e,n)}_parseMessage({data:t}){return t&&"object"==typeof t?t.protocol!==Ft||t.version!==Bt?null:Array.isArray(t.arguments)?t:null:null}_handle(t){const e=this._parseMessage(t),n=this._port;if(e&&n)if("method"in e){if("close"===e.method){if(this._receivedCloseEvent)return;this._receivedCloseEvent=!0}const t=this._methods.get(e.method);if(!t)return
;const i=(...t)=>{const i={arguments:t,protocol:Ft,response:e.sequence,version:Bt};n.postMessage(i)};t(...e.arguments,i)}else if("response"in e){const t=this._callbacks.get(e.response);this._callbacks.delete(e.response),t&&t(...e.arguments)}}}function qt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ut(t){for(var e={},n=t.querySelectorAll("script.js-hypothesis-config"),i=0;i<n.length;i++){var o=void 0;try{o=JSON.parse(n[i].textContent||"")}catch(t){console.warn("Could not parse settings from js-hypothesis-config tags",t),o={}}Object.assign(e,o)}return e}function zt(t){if("string"==typeof t&&"false"===t.trim().toLocaleLowerCase())return!1;const e=Number(t);return isNaN(e)?"string"==typeof t:Boolean(e)}function $t(t,e,n){const i=t.document.querySelector(`link[type="application/annotator+${n}"][rel="${e}"]`);if(!i)throw new Error(`No application/annotator+${n} (rel="${e}") link in the document`);if(!i.href)throw new Error(`application/annotator+${n} (rel="${e}") link has no href`);return i.href}
function Wt(t){return"string"==typeof t?t:null}function jt(t){const e=function(t){if(!qt(t,"hypothesisConfig"))return{};if("function"!=typeof t.hypothesisConfig){const t="https://h.readthedocs.io/projects/client/en/latest/publishers/config/#window.hypothesisConfig";return console.warn("hypothesisConfig must be a function, see: "+t),{}}return t.hypothesisConfig()}(t);let n;function i(t){return qt(e,t)?e[t]:qt(n,t)?n[t]:void 0}return n=zt(e.ignoreOtherConfiguration)?{}:Ut(t.document),{get annotations(){return Wt(n.annotations)||function(){const e=t.location.href.match(/#annotations:([A-Za-z0-9_-]+)$/);return e?e[1]:null}()},get clientUrl(){return $t(t,"hypothesis-client","javascript")},get group(){return Wt(n.group)||function(){const e=t.location.href.match(/#annotations:group:([A-Za-z0-9_-]+)$/);return e?e[1]:null}()},get notebookAppUrl(){return $t(t,"notebook","html")},get showHighlights(){return function(){const t=i("showHighlights");switch(t){case"always":case"never":case"whenSidebarOpen":return t;case!0:
return"always";case!1:return"never";default:return"always"}}()},get sidebarAppUrl(){return $t(t,"sidebar","html")},get query(){return Wt(n.query)||function(){const e=t.location.href.match(/#annotations:(query|q):(.+)$/i);if(e)try{return decodeURIComponent(e[2])}catch(t){}return null}()},hostPageSetting:i}}function Xt(t,e){return t.hostPageSetting(e)}const Yt={annotations:{allowInBrowserExt:!0,defaultValue:null,getValue:t=>t.annotations},appType:{allowInBrowserExt:!0,defaultValue:null,getValue:Xt},branding:{defaultValue:null,allowInBrowserExt:!1,getValue:Xt},clientUrl:{allowInBrowserExt:!0,defaultValue:null,getValue:t=>t.clientUrl},contentInfoBanner:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},enableExperimentalNewNoteButton:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},group:{allowInBrowserExt:!0,defaultValue:null,getValue:t=>t.group},focus:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},theme:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},usernameUrl:{allowInBrowserExt:!1,
defaultValue:null,getValue:Xt},onLayoutChange:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},openSidebar:{allowInBrowserExt:!0,defaultValue:!1,coerce:zt,getValue:Xt},query:{allowInBrowserExt:!0,defaultValue:null,getValue:t=>t.query},requestConfigFromFrame:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},services:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt},showHighlights:{allowInBrowserExt:!1,defaultValue:"always",getValue:t=>t.showHighlights},notebookAppUrl:{allowInBrowserExt:!0,defaultValue:null,getValue:t=>t.notebookAppUrl},sidebarAppUrl:{allowInBrowserExt:!0,defaultValue:null,getValue:t=>t.sidebarAppUrl},subFrameIdentifier:{allowInBrowserExt:!0,defaultValue:null,getValue:Xt},externalContainerSelector:{allowInBrowserExt:!1,defaultValue:null,getValue:Xt}};function Zt(t,e=window){const n=jt(e),i={};for(let r of function(t){const e={annotator:["clientUrl","contentInfoBanner","subFrameIdentifier"],
sidebar:["appType","annotations","branding","enableExperimentalNewNoteButton","externalContainerSelector","focus","group","onLayoutChange","openSidebar","query","requestConfigFromFrame","services","showHighlights","sidebarAppUrl","theme","usernameUrl"],notebook:["branding","group","notebookAppUrl","requestConfigFromFrame","services","theme","usernameUrl"]};switch(t){case"annotator":return e.annotator;case"sidebar":return e.sidebar;case"notebook":return e.notebook;case"all":return[...e.annotator,...e.sidebar,...e.notebook];default:throw new Error(`Invalid application context used: "${t}"`)}}(t)){const t=Yt[r],s=void 0!==t.defaultValue,a=!((o=$t(e,"sidebar","html")).startsWith("http://")||o.startsWith("https://"));if(!t.allowInBrowserExt&&a){s&&(i[r]=t.defaultValue);continue}const l=t.getValue(n,r);void 0!==l?i[r]=t.coerce?t.coerce(l):l:s&&(i[r]=t.defaultValue)}var o;return i}const Gt={alt:1,ctrl:2,meta:4,shift:8};function Kt(t,e){const n=e.split("+").map((t=>t.toLowerCase()));let i=0,o=null;for(const t of n){
const e=Gt[t];if(e)i|=e;else{if(null!==o)throw new Error("Multiple non-modifier keys specified");o=t}}if(!o)throw new Error(`Invalid shortcut: ${e}`);return((t.ctrlKey?Gt.ctrl:0)|(t.metaKey?Gt.meta:0)|(t.altKey?Gt.alt:0)|(t.shiftKey?Gt.shift:0))===i&&t.key.toLowerCase()===o}function Qt(t,e,{rootElement:n}={}){K((()=>{if(t)return function(t,e,{rootElement:n=document.documentElement}={}){const i=n=>{Kt(n,t)&&e(n)};return n.addEventListener("keydown",i),()=>n.removeEventListener("keydown",i)}(t,e,{rootElement:n})}),[t,e,n])}var Jt="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Annotate.js";function te(t){return ct("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",...t,children:ct("path",{fill:"currentColor",
d:"M15 0c.27 0 .505.099.703.297A.961.961 0 0 1 16 1v15l-4-3H1a.974.974 0 0 1-.703-.29A.953.953 0 0 1 0 12V1A.96.96 0 0 1 .29.29.966.966 0 0 1 1 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 0 1 .008.11l-.002.074-.006.066a1.447 1.447 0 0 0 .43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 0 0 5.5 6a1.467 1.467 0 0 0-.422.062c.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 0 1 .008.11l-.002.074-.006.066a1.447 1.447 0 0 0 .43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0 0 10.5 6a1.467 1.467 0 0 0-.422.062c.177-1.03.542-1.632 1.094-1.804L12 4V3z"},void 0,!1,{fileName:Jt,lineNumber:17,columnNumber:7})},void 0,!1,{fileName:Jt,lineNumber:10,columnNumber:5})}
var ee="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CaretDown.js";function ne(t){return ct("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",...t,children:ct("g",{"fill-rule":"evenodd",fill:"none",children:[ct("path",{d:"M0 0h16v16H0z"},void 0,!1,{fileName:ee,lineNumber:19,columnNumber:9}),ct("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m12 6-4 4-4-4"},void 0,!1,{fileName:ee,lineNumber:20,columnNumber:9})]},void 0,!0,{fileName:ee,lineNumber:18,columnNumber:7})},void 0,!1,{fileName:ee,lineNumber:10,columnNumber:5})}var ie="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CaretLeft.js";function oe(t){return ct("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",...t,children:ct("g",{"fill-rule":"evenodd",fill:"none",children:[ct("path",{d:"M0 0h16v16H0z"},void 0,!1,{fileName:ie,lineNumber:19,
columnNumber:9}),ct("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 12 6 8l4-4"},void 0,!1,{fileName:ie,lineNumber:20,columnNumber:9})]},void 0,!0,{fileName:ie,lineNumber:18,columnNumber:7})},void 0,!1,{fileName:ie,lineNumber:10,columnNumber:5})}var re="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/CaretRight.js";function se(t){return ct("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",...t,children:ct("g",{"fill-rule":"evenodd",fill:"none",children:[ct("path",{d:"M0 0h16v16H0z"},void 0,!1,{fileName:re,lineNumber:19,columnNumber:9}),ct("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m6 4 4 4-4 4"},void 0,!1,{fileName:re,lineNumber:20,columnNumber:9})]},void 0,!0,{fileName:re,lineNumber:18,columnNumber:7})},void 0,!1,{fileName:re,lineNumber:10,columnNumber:5})}
var ae="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Hide.js";function le(t){return ct("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",...t,children:ct("path",{fill:"currentColor",d:"m1.613.21.094.083 14 14a1 1 0 0 1-1.32 1.497l-.094-.083-14-14A1 1 0 0 1 1.613.21Zm.583 4.845a1 1 0 0 1 .292 1.384C2.165 6.935 2 7.46 2 8c0 2.123 2.628 4 6 4 .22 0 .44-.008.657-.024a1 1 0 0 1 .147 1.994c-.266.02-.534.03-.804.03-4.36 0-8-2.6-8-6 0-.937.283-1.84.812-2.653a1 1 0 0 1 1.384-.292ZM8 2c4.36 0 8 2.6 8 6 0 .937-.283 1.84-.812 2.653a1 1 0 0 1-1.676-1.092C13.835 9.065 14 8.54 14 8c0-2.123-2.628-4-6-4-.22 0-.44.008-.657.024a1 1 0 1 1-.147-1.994C7.462 2.01 7.73 2 8 2Z"},void 0,!1,{fileName:ae,lineNumber:18,columnNumber:7})},void 0,!1,{fileName:ae,lineNumber:10,columnNumber:5})}var ce="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/Highlight.js";function he(t){return ct("svg",{xmlns:"http://www.w3.org/2000/svg",
width:"16",height:"16",viewBox:"0 0 16 16","aria-hidden":"true",...t,children:ct("g",{"fill-rule":"evenodd",fill:"none",children:[ct("path",{d:"M0 0h16v16H0z"},void 0,!1,{fileName:ce,lineNumber:19,columnNumber:9}),ct("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15H1h11zm-.5-6v2l-1 1v-2l1-1zm.5-7v6h-2V2h2zm0-1h-2 2zm0 8h-2 2z"},void 0,!1,{fileName:ce,lineNumber:20,columnNumber:9})]},void 0,!0,{fileName:ce,lineNumber:18,columnNumber:7})},void 0,!1,{fileName:ce,lineNumber:10,columnNumber:5})}var ue="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/PointerDown.js";function de(t){return ct("svg",{width:"16",height:"9",xmlns:"http://www.w3.org/2000/svg",...t,children:ct("path",{d:"m15.5 0-7 8-8-8",stroke:"currentColor"},void 0,!1,{fileName:ue,lineNumber:11,columnNumber:7})},void 0,!1,{fileName:ue,lineNumber:10,columnNumber:5})}var fe="/home/runner/work/frontend-shared/frontend-shared/src/components/icons/PointerUp.js"
;function pe(t){return ct("svg",{width:"16",height:"9",xmlns:"http://www.w3.org/2000/svg",...t,children:ct("path",{d:"m.5 9 7-8 8 8",stroke:"currentColor"},void 0,!1,{fileName:fe,lineNumber:11,columnNumber:7})},void 0,!1,{fileName:fe,lineNumber:10,columnNumber:5})}B({}),B({}),B({});const ge=function({elementRef:t,children:e,classes:n,unstyled:i=!1,expanded:o,pressed:r,title:s,role:a,...l}){const h={"aria-label":s};return"tab"===a?h["aria-selected"]=r:(h["aria-pressed"]=r,h["aria-expanded"]=o),ct("button",{role:null!=a?a:"button",...h,"data-base-component":"ButtonBase","data-component":"ButtonBase",...l,className:c({"focus-visible-ring":!i,"transition-colors":!i,"whitespace-nowrap flex items-center":!i},n),title:s,ref:t,children:e},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/input/ButtonBase.js",lineNumber:59,columnNumber:5})};var me="/home/runner/work/frontend-shared/frontend-shared/src/components/input/Button.js"
;const _e=function({children:t,classes:e,elementRef:n,expanded:i,pressed:o,title:r,icon:s,size:a="md",variant:l="secondary",...h}){return ct(ge,{...h,classes:c("focus-visible-ring transition-colors whitespace-nowrap flex items-center","font-semibold rounded-sm",{"text-grey-7 bg-grey-1 enabled:hover:text-grey-9 enabled:hover:bg-grey-2 aria-pressed:text-grey-9 aria-expanded:text-grey-9":"secondary"===l,"text-grey-1 bg-grey-7 enabled:hover:bg-grey-8 disabled:text-grey-4":"primary"===l},{"p-2 gap-x-2":"md"===a,"p-1 gap-x-1":"xs"===a,"p-1.5 gap-x-1.5":"sm"===a,"p-2.5 gap-x-1.5":"lg"===a},e),elementRef:n,expanded:i,pressed:o,title:r,"data-component":"Button",unstyled:!0,children:[s&&ct(s,{className:"w-em h-em"},void 0,!1,{fileName:me,lineNumber:70,columnNumber:16}),t]},void 0,!0,{fileName:me,lineNumber:42,columnNumber:5})};c("input-group:border input-group:rounded-none","input-group:first:rounded-l-sm input-group:last:rounded-r-sm","input-group:border-l-0 input-group:first:border-l")
;const ve=function({children:t,classes:e,elementRef:n,active:i=!1,variant:o="raised",width:r="full",...s}){return ct("div",{...s,ref:n,className:c("rounded-sm border bg-white",{"shadow hover:shadow-md":"raised"===o,"shadow-md":i&&"raised"===o},{"w-full":"full"===r,"w-auto":"auto"===r},e),"data-component":"Card",children:t},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/Card.js",lineNumber:36,columnNumber:5})};const ye=function({children:t,classes:e,elementRef:n,size:i="md",...o}){return ct("div",{...o,ref:n,className:c({"p-3 space-y-4":"md"===i,"p-2 space-y-3":"sm"===i,"p-4 space-y-6":"lg"===i},e),"data-component":"CardContent",children:t},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/layout/CardContent.js",lineNumber:28,columnNumber:5})};const be=function({children:t,classes:e,elementRef:n,unstyled:i=!1,...o}){return ct("a",{"data-base-component":"LinkBase","data-component":"LinkBase",...o,className:c({
"focus-visible-ring":!i},e),rel:"noopener noreferrer",ref:n,children:t},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/LinkBase.js",lineNumber:24,columnNumber:5})};const we=function({children:t,classes:e,elementRef:n,underline:i="none",color:o="brand",...r}){return ct(be,{...r,classes:c("rounded-sm",{"text-brand hover:text-brand-dark":"brand"===o,"text-color-text-light hover:text-brand":"text-light"===o,"text-color-text hover:text-brand-dark":"text"===o},{"no-underline hover:no-underline":"none"===i,"underline hover:underline":"always"===i,"no-underline hover:underline":"hover"===i},e),elementRef:n,"data-component":"Link",children:t},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/navigation/Link.js",lineNumber:32,columnNumber:5})};function Ce({badgeCount:t}){return ct("span",{className:c("rounded px-1 py-0.5","bg-current"),children:ct("span",{className:"font-bold text-color-text-inverted",children:t})})}
function xe({arrowDirection:t}){return ct("div",{className:c("absolute left-1/2 -translate-x-1/2 z-2","fill-white text-grey-3",{"top-0 -translate-y-full":"up"===t}),children:ct("up"===t?pe:de,{})})}function Se({badgeCount:t,icon:e,label:n,onClick:i,shortcut:o}){Qt(o,i);const r=o?`${n} (${o})`:n;return ct(ge,{classes:c("flex-col gap-y-1 py-2.5 px-2","text-annotator-sm leading-none","text-grey-7","group-hover:text-grey-5","hover:group-hover:text-grey-9"),onClick:i,title:r,children:[e&&ct(e,{className:"text-annotator-lg",title:r}),"number"==typeof t&&ct(Ce,{badgeCount:t}),ct("span",{children:n})]})}function Ee({annotationCount:t,isVisible:e}){return ct("div",{className:"sr-only",children:[ct("span",{"aria-live":"polite","aria-atomic":"true",role:"status","data-testid":"annotation-count-announce",children:t>0&&ct("span",{children:[t," ",1===t?"annotation":"annotations"," for this selection."]})}),ct("ul",{"aria-live":"polite","data-testid":"annotate-shortcuts-announce",children:e&&ct(m,{children:[t>0&&ct("li",{
children:["Press ","'S'"," to show annotations."]}),ct("li",{children:["Press ","'A'"," to annotate."]}),ct("li",{children:["Press ","'H'"," to highlight."]})]})})]})}function ke({arrowDirection:t,isVisible:e,onCommand:n,annotationCount:i=0}){const o=e?"a":null,r=e?"h":null,s=e?"s":null;return Qt(e?"Escape":null,(()=>n("hide"))),ct("div",{className:c("all-initial","border border-solid border-grey-3","absolute select-none bg-white rounded shadow-adder-toolbar","opacity-5",{"animate-adder-pop-up":"up"===t&&e,"animate-adder-pop-down":"down"===t&&e}),"data-component":"AdderToolbar",dir:"ltr",style:{visibility:e?"visible":"hidden"},children:[ct("div",{className:c("flex group"),children:[ct(Se,{icon:te,onClick:()=>n("annotate"),label:"Annotate",shortcut:o}),ct(Se,{icon:he,onClick:()=>n("highlight"),label:"Highlight",shortcut:r}),i>0&&ct(m,{children:[ct("div",{className:c("m-1.5 border-r border-grey-4 border-solid")}),ct(Se,{badgeCount:i,onClick:()=>n("show"),label:"Show",shortcut:s})]})]}),ct(xe,{arrowDirection:t
}),ct(Ee,{annotationCount:i,isVisible:e})]})}const Ne=(t=window)=>t.matchMedia("(pointer: coarse)").matches;function Ae(t){const e=t.attachShadow({mode:"open"});!function(t){var e;const n=null===(e=document.querySelector('link[rel="preload"][href*="/build/styles/annotator.css"]'))||void 0===e?void 0:e.href;if(!n)return;const i=document.createElement("link");i.rel="stylesheet",i.href=n,t.appendChild(i)}(e);const n=window.applyFocusVisiblePolyfill;var i;return n&&n(e),(i=e).addEventListener("mouseup",(t=>t.stopPropagation())),i.addEventListener("mousedown",(t=>t.stopPropagation())),i.addEventListener("touchstart",(t=>t.stopPropagation()),{passive:!0}),e}function Te(t){return t.toString()+"px"}class Re{constructor(t,e){this._outerContainer=document.createElement("hypothesis-adder"),t.appendChild(this._outerContainer),this._shadowRoot=Ae(this._outerContainer),Object.assign(this._outerContainer.style,{position:"absolute",top:0,left:0}),this._view=t.ownerDocument.defaultView,
this._width=()=>this._shadowRoot.firstChild.getBoundingClientRect().width,this._height=()=>this._shadowRoot.firstChild.getBoundingClientRect().height,this._isVisible=!1,this._arrowDirection="up",this._onAnnotate=e.onAnnotate,this._onHighlight=e.onHighlight,this._onShowAnnotations=e.onShowAnnotations,this._annotationsForSelection=[],this._render()}get annotationsForSelection(){return this._annotationsForSelection}set annotationsForSelection(t){this._annotationsForSelection=t,this._render()}hide(){this._isVisible=!1,this._render(),Object.assign(this._outerContainer.style,{top:0,left:0})}destroy(){I(null,this._shadowRoot),this._outerContainer.remove()}show(t,e){const{left:n,top:i,arrowDirection:o}=this._calculateTarget(t,e);this._showAt(n,i),this._isVisible=!0,this._arrowDirection=2===o?"up":"down",this._render()}_calculateTarget(t,e){let n,i,o;n=e&&!Ne()?1:2;const r=Math.min(20,t.width),s=this._width(),a=Ne()?10:0,l=this._height();return o=e?t.left-s/2+r:t.left+t.width-s/2-r,
t.top-l<0&&1===n?n=2:t.top+l>this._view.innerHeight&&(n=1),i=2===n?t.top+t.height+10+a:t.top-l-10,o=Math.max(o,0),o=Math.min(o,this._view.innerWidth-s),i=Math.max(i,0),i=Math.min(i,this._view.innerHeight-l),{top:i,left:o,arrowDirection:n}}_findZindex(t,e){if(void 0===document.elementsFromPoint)return 32768;const n=this._width(),i=this._height(),o=[...new Set([...document.elementsFromPoint(t,e),...document.elementsFromPoint(t,e+i),...document.elementsFromPoint(t+n/2,e+i/2),...document.elementsFromPoint(t+n,e),...document.elementsFromPoint(t+n,e+i)])].map((t=>+getComputedStyle(t).zIndex)).filter(Number.isInteger);return o.push(0),Math.max(...o)+1}_showAt(t,e){const n=function(t){let e=t.parentElement;for(;e.parentElement&&"static"===getComputedStyle(e).position;)e=e.parentElement;return e}(this._outerContainer).getBoundingClientRect(),i=this._findZindex(t,e);Object.assign(this._outerContainer.style,{left:Te(t-n.left),top:Te(e-n.top),zIndex:i})}_render(){I(ct(ke,{isVisible:this._isVisible,
arrowDirection:this._arrowDirection,onCommand:t=>{switch(t){case"annotate":this._onAnnotate(),this.hide();break;case"highlight":this._onHighlight(),this.hide();break;case"show":this._onShowAnnotations(this.annotationsForSelection);break;case"hide":this.hide()}},annotationCount:this.annotationsForSelection.length}),this._shadowRoot)}}function Le(t){switch(t.nodeType){case Node.ELEMENT_NODE:case Node.TEXT_NODE:return t.textContent.length;default:return 0}}function Pe(t){let e=t.previousSibling,n=0;for(;e;)n+=Le(e),e=e.previousSibling;return n}function Me(t,...e){let n=e.shift();const i=t.ownerDocument.createNodeIterator(t,NodeFilter.SHOW_TEXT),o=[];let r,s=i.nextNode(),a=0;for(;void 0!==n&&s;)r=s,a+r.data.length>n?(o.push({node:r,offset:n-a}),n=e.shift()):(s=i.nextNode(),a+=r.data.length);for(;void 0!==n&&r&&a===n;)o.push({node:r,offset:r.data.length}),n=e.shift();if(void 0!==n)throw new RangeError("Offset exceeds text length");return o}class Oe{constructor(t,e){if(e<0)throw new Error("Offset is invalid")
;this.element=t,this.offset=e}relativeTo(t){if(!t.contains(this.element))throw new Error("Parent is not an ancestor of current element");let e=this.element,n=this.offset;for(;e!==t;)n+=Pe(e),e=e.parentElement;return new Oe(e,n)}resolve(t={}){try{return Me(this.element,this.offset)[0]}catch(e){if(0===this.offset&&void 0!==t.direction){const n=document.createTreeWalker(this.element.getRootNode(),NodeFilter.SHOW_TEXT);n.currentNode=this.element;const i=1===t.direction,o=i?n.nextNode():n.previousNode();if(!o)throw e;return{node:o,offset:i?0:o.data.length}}throw e}}static fromCharOffset(t,e){switch(t.nodeType){case Node.TEXT_NODE:return Oe.fromPoint(t,e);case Node.ELEMENT_NODE:return new Oe(t,e);default:throw new Error("Node is not an element or text node")}}static fromPoint(t,e){switch(t.nodeType){case Node.TEXT_NODE:{if(e<0||e>t.data.length)throw new Error("Text node offset is out of range");if(!t.parentElement)throw new Error("Text node has no parent");const n=Pe(t)+e;return new Oe(t.parentElement,n)}
case Node.ELEMENT_NODE:{if(e<0||e>t.childNodes.length)throw new Error("Child node offset is out of range");let n=0;for(let i=0;i<e;i++)n+=Le(t.childNodes[i]);return new Oe(t,n)}default:throw new Error("Point is not in an element or text node")}}}class Ie{constructor(t,e){this.start=t,this.end=e}relativeTo(t){return new Ie(this.start.relativeTo(t),this.end.relativeTo(t))}toRange(){let t,e;this.start.element===this.end.element&&this.start.offset<=this.end.offset?[t,e]=Me(this.start.element,this.start.offset,this.end.offset):(t=this.start.resolve({direction:1}),e=this.end.resolve({direction:2}));const n=new Range;return n.setStart(t.node,t.offset),n.setEnd(e.node,e.offset),n}static fromRange(t){const e=Oe.fromPoint(t.startContainer,t.startOffset),n=Oe.fromPoint(t.endContainer,t.endOffset);return new Ie(e,n)}static fromOffsets(t,e,n){return new Ie(new Oe(t,e),new Oe(t,n))}}const Be=".annotator-placeholder";function Fe(t){return!!t.parentElement&&null!==t.parentElement.closest(Be)}function He(t){
if(t.focusNode===t.anchorNode)return t.focusOffset<t.anchorOffset;return t.getRangeAt(0).startContainer===t.focusNode}function De(t,e){try{var n,i;const o=null!==(n=null===(i=e.nodeValue)||void 0===i?void 0:i.length)&&void 0!==n?n:e.childNodes.length;return t.comparePoint(e,0)<=0&&t.comparePoint(e,o)>=0}catch(t){return!1}}function Ve(t,e){const n=t.commonAncestorContainer,i=n.ownerDocument.createNodeIterator(n,NodeFilter.SHOW_ALL);let o;for(;o=i.nextNode();)De(t,o)&&e(o)}function qe(t){if(t.isCollapsed)return null;const e=function(t){const e=/^\s*$/,n=[];Ve(t,(t=>{t.nodeType!==Node.TEXT_NODE||t.textContent.match(e)||n.push(t)}));let i=[];return n.forEach((e=>{const n=e.ownerDocument.createRange();if(n.selectNodeContents(e),e===t.startContainer&&n.setStart(e,t.startOffset),e===t.endContainer&&n.setEnd(e,t.endOffset),n.collapsed)return;const o=Array.from(n.getClientRects());n.detach(),i=i.concat(o)})),i}(t.getRangeAt(0));return 0===e.length?null:He(t)?e[0]:e[e.length-1]}const Ue="http://www.w3.org/2000/svg"
;function ze(t,e){const n=function(t){if(t.collapsed)return[];let e=t.commonAncestorContainer;if(e&&e.nodeType!==Node.ELEMENT_NODE&&(e=e.parentElement),!e)return[];const n=[],i=e.ownerDocument.createNodeIterator(e,NodeFilter.SHOW_TEXT);let o;for(;o=i.nextNode();){if(!De(t,o))continue;const e=o;e===t.startContainer&&t.startOffset>0?e.splitText(t.startOffset):(e===t.endContainer&&t.endOffset<e.data.length&&e.splitText(t.endOffset),n.push(e))}return n}(t),i=n.length>0&&Fe(n[0]);let o=[],r=null,s=null;n.forEach((t=>{r&&r.nextSibling===t?s.push(t):(s=[t],o.push(s)),r=t}));const a=/^\s*$/;o=o.filter((t=>t.some((t=>!a.test(t.data)))));const l=[];return o.forEach((t=>{const n=document.createElement("hypothesis-highlight");n.className=c("hypothesis-highlight",e);t[0].parentNode.replaceChild(n,t[0]),t.forEach((t=>n.appendChild(t))),l.push(n)})),i||function(t,e){if(0===t.length)return;const n=function(t){const e=t.closest(".page");return e&&e.querySelector(".canvasWrapper > canvas")||null}(t[0])
;if(!n||!n.parentElement)return;let i=n.parentElement.querySelector(".hypothesis-highlight-layer");if(!i){i=document.createElementNS(Ue,"svg"),i.setAttribute("class","hypothesis-highlight-layer"),n.parentElement.appendChild(i),n.parentElement.style.position="relative";const t=i.style;t.position="absolute",t.left="0",t.top="0",t.width="100%",t.height="100%",t.mixBlendMode="multiply"}const o=n.getBoundingClientRect(),r=t.map((t=>{const n=t.getBoundingClientRect(),i=document.createElementNS(Ue,"rect");return i.setAttribute("x",(n.left-o.left).toString()),i.setAttribute("y",(n.top-o.top).toString()),i.setAttribute("width",n.width.toString()),i.setAttribute("height",n.height.toString()),i.setAttribute("class",c("hypothesis-svg-highlight",e)),t.classList.add("is-transparent"),t.svgHighlight=i,i}));i.append(...r)}(l,e),l}function $e(t,e){const n=t.parentNode;e.forEach((e=>n.insertBefore(e,t))),t.remove()}function We(t){for(const e of t){if(e.parentNode){$e(e,Array.from(e.childNodes))}
e.svgHighlight&&e.svgHighlight.remove()}}function je(t,e){t.forEach((t=>{if(t.svgHighlight){if(t.svgHighlight.classList.toggle("is-focused",e),e){t.svgHighlight.parentNode.append(t.svgHighlight)}}else t.classList.toggle("hypothesis-highlight-focused",e)}))}function Xe(t){const e=t.map((t=>t.getBoundingClientRect()));return e.reduce(((t,e)=>({top:Math.min(t.top,e.top),left:Math.min(t.left,e.left),bottom:Math.max(t.bottom,e.bottom),right:Math.max(t.right,e.right)})))}class Ye{constructor({contentContainer:t,hostRPC:e}){this._hostRPC=e,this._updatePending=!1,this._anchors=[],this._listeners=new Ct,this._listeners.add(window,"resize",(()=>this.update())),this._listeners.add(window,"scroll",(()=>this.update())),this._listeners.add(t,"scroll",(()=>this.update()))}destroy(){this._listeners.removeAll()}update(t){t&&(this._anchors=t),this._updatePending||(this._updatePending=!0,requestAnimationFrame((()=>{const t=function(t){const e=[];return t.forEach((({annotation:t,highlights:n})=>{if(null==n||!n.length)return
;const{top:i,bottom:o}=Xe(n);i>=o||e.push({tag:t.$tag,top:i,bottom:o})})),e.sort(((t,e)=>t.top-e.top)),e}(this._anchors);this._hostRPC.call("anchorsChanged",t),this._updatePending=!1})))}}function Ze({cluster:t,label:e,onChange:n,currentStyles:i,highlightStyles:o}){const r=i[t],s="transparent"===r;return ct("div",{className:"space-y-2",children:[ct("div",{className:"flex items-center gap-x-2 text-annotator-base",children:ct("div",{className:"grow text-color-text px-2 py-1 rounded",style:{backgroundColor:o[r].color},children:e})}),ct("div",{className:"flex items-center gap-x-2",children:Object.keys(o).map((e=>ct("div",{className:"relative",children:[ct("input",{className:c("absolute w-6 h-6","opacity-[.00001]","cursor-pointer"),name:t,id:`hypothesis-${t}-${e}`,checked:r===e,onChange:n,type:"radio",value:e}),ct("label",{className:"block",htmlFor:`${t}-${e}`,children:[ct("div",{style:{backgroundColor:o[e].color},className:c("block w-6 h-6 rounded-full flex items-center justify-center",{
"border-2 border-slate-0":r!==e,"border-2 border-slate-3":r===e}),children:"transparent"===e&&ct(le,{className:c("w-3 h-3",{"text-slate-3":!s,"text-slate-7":s})})}),ct("span",{className:"sr-only",children:e})]})]},`${t}-${e}`)))})]})}function Ge({active:t,availableStyles:e,currentStyles:n,onStyleChange:i}){const o=function(t,e){return q=8,tt((function(){return t}),e)}((t=>{const e=t.target,n=e.name,o=e.value;i(n,o)}),[i]),[r,s]=G(!1);return t?ct(ve,{children:ct("div",{className:"flex flex-col text-annotator-base text-color-text",children:[ct(_e,{"data-testid":"control-toggle-button",onClick:()=>s(!r),title:r?"Hide highlight settings":"Show highlight settings",children:ct(m,r?{children:[ct(ne,{}),ct("span",{children:"Highlight Appearance"})]}:{children:[ct(se,{}),ct(he,{})]})}),r&&ct(ye,{"data-testid":"cluster-style-controls",size:"sm",children:[ct(Ze,{highlightStyles:e,label:"My annotations",cluster:"user-annotations",onChange:o,currentStyles:n}),ct(Ze,{highlightStyles:e,label:"My highlights",
cluster:"user-highlights",onChange:o,currentStyles:n}),ct(Ze,{highlightStyles:e,label:"Everybody's content",cluster:"other-content",onChange:o,currentStyles:n})]})]})}):null}const Ke={transparent:{color:"transparent",secondColor:"transparent",thirdColor:"transparent"},pink:{color:"var(--hypothesis-color-pink)",secondColor:"var(--hypothesis-color-pink-1)",thirdColor:"var(--hypothesis-color-pink-2)"},orange:{color:"var(--hypothesis-color-orange)",secondColor:"var(--hypothesis-color-orange-1)",thirdColor:"var(--hypothesis-color-orange-2)"},yellow:{color:"var(--hypothesis-color-yellow)",secondColor:"var(--hypothesis-color-yellow-1)",thirdColor:"var(--hypothesis-color-yellow-2)"},green:{color:"var(--hypothesis-color-green)",secondColor:"var(--hypothesis-color-green-1)",thirdColor:"var(--hypothesis-color-green-2)"},purple:{color:"var(--hypothesis-color-purple)",secondColor:"var(--hypothesis-color-purple-1)",thirdColor:"var(--hypothesis-color-purple-2)"},grey:{color:"var(--hypothesis-color-grey)",
secondColor:"var(--hypothesis-color-grey-1)",thirdColor:"var(--hypothesis-color-grey-2)"}},Qe={"other-content":"yellow","user-annotations":"orange","user-highlights":"purple"};class Je{constructor(t,e){wt(this,"appliedStyles",void 0),wt(this,"_element",void 0),wt(this,"_features",void 0),wt(this,"_outerContainer",void 0),wt(this,"_shadowRoot",void 0),this._element=t,this._features=e.features,this._outerContainer=document.createElement("hypothesis-highlight-cluster-toolbar"),this._element.appendChild(this._outerContainer),this._shadowRoot=Ae(this._outerContainer),Object.assign(this._outerContainer.style,{position:"fixed",top:`${this._element.offsetTop+4}px`,left:"4px"}),this.appliedStyles=Qe,this._init(),this._features.on("flagsChanged",(()=>{this._activate(this._isActive())})),this._render()}destroy(){I(null,this._shadowRoot),this._activate(!1),this._outerContainer.remove()}_init(){for(const t of Object.keys(this.appliedStyles))this._setClusterStyles(t,this.appliedStyles[t]);this._activate(this._isActive())}
_isActive(){return this._features.flagEnabled("styled_highlight_clusters")}_activate(t){this._element.classList.toggle("hypothesis-highlights-clustered",t),this._render()}_setClusterStyle(t,e){document.documentElement.style.setProperty(t,e)}_setClusterStyles(t,e){const n=Ke[e];for(const e of Object.keys(n))this._setClusterStyle(`--hypothesis-${t}-${e}`,n[e])}_onChangeClusterStyle(t,e){this.appliedStyles[t]=e,this._setClusterStyles(t,e),this._render()}_render(){I(ct(Ge,{active:this._isActive(),availableStyles:Ke,currentStyles:this.appliedStyles,onStyleChange:(t,e)=>this._onChangeClusterStyle(t,e)}),this._shadowRoot)}}let tn=new Set;function en(...t){const e=t.join();tn.has(e)||(console.warn(...t),tn.add(e))}en.reset=()=>{tn.clear()};const nn=["book_as_single_document","html_side_by_side","styled_highlight_clusters"];class on extends Rt{constructor(t=nn){super(),this._flags=new Map,this._knownFlags=t}update(t){this._flags.clear();for(let[e,n]of Object.entries(t))this._flags.set(e,n);this.emit("flagsChanged")}
flagEnabled(t){var e;return this._knownFlags.includes(t)?null!==(e=this._flags.get(t))&&void 0!==e&&e:(en("Looked up unknown feature",t),!1)}allFlags(){return Object.fromEntries(this._flags)}}function rn(t){return t.split("").reverse().join("")}function sn(t){return(t|-t)>>31&1}function an(t,e,n,i){let o=t.P[n],r=t.M[n];const s=i>>>31,a=e[n]|s,l=a|r,c=(a&o)+o^o|a;let h=r|~(c|o),u=o&c;const d=sn(h&t.lastRowMask[n])-sn(u&t.lastRowMask[n]);return h<<=1,u<<=1,u|=s,h|=sn(i)-s,o=u|~(l|h),r=h&l,t.P[n]=o,t.M[n]=r,d}function ln(t,e,n){if(0===e.length)return[];n=Math.min(n,e.length);const i=[],o=32,r=Math.ceil(e.length/o)-1,s={P:new Uint32Array(r+1),M:new Uint32Array(r+1),lastRowMask:new Uint32Array(r+1)};s.lastRowMask.fill(1<<31),s.lastRowMask[r]=1<<(e.length-1)%o;const a=new Uint32Array(r+1),l=new Map,c=[];for(let t=0;t<256;t++)c.push(a);for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(l.has(n))continue;const i=new Uint32Array(r+1);l.set(n,i),n<c.length&&(c[n]=i);for(let t=0;t<=r;t+=1){i[t]=0
;for(let r=0;r<o;r+=1){const s=t*o+r;if(s>=e.length)continue;e.charCodeAt(s)===n&&(i[t]|=1<<r)}}}let h=Math.max(0,Math.ceil(n/o)-1);const u=new Uint32Array(r+1);for(let t=0;t<=h;t+=1)u[t]=(t+1)*o;u[r]=e.length;for(let t=0;t<=h;t+=1)s.P[t]=-1,s.M[t]=0;for(let d=0;d<t.length;d+=1){const f=t.charCodeAt(d);let p;f<c.length?p=c[f]:(p=l.get(f),void 0===p&&(p=a));let g=0;for(let t=0;t<=h;t+=1)g=an(s,p,t,g),u[t]+=g;if(u[h]-g<=n&&h<r&&(1&p[h+1]||g<0)){let t;if(h+=1,s.P[h]=-1,s.M[h]=0,h===r){const n=e.length%o;t=0===n?o:n}else t=o;u[h]=u[h-1]+t-g+an(s,p,h,g)}else for(;h>0&&u[h]>=n+o;)h-=1;h===r&&u[h]<=n&&(u[h]<n&&i.splice(0,i.length),i.push({start:-1,end:d+1,errors:u[h]}),n=u[h])}return i}function cn(t,e,n){return function(t,e,n){const i=rn(e);return n.map((n=>{const o=Math.max(0,n.end-e.length-n.errors);return{start:ln(rn(t.slice(o,n.end)),i,n.errors).reduce(((t,e)=>n.end-e.end<t?n.end-e.end:t),n.end),end:n.end,errors:n.errors}}))}(t,e,ln(t,e,n))}function hn(t,e,n){let i=0,o=[];for(;-1!==i;)i=t.indexOf(e,i),
-1!==i&&(o.push({start:i,end:i+e.length,errors:0}),i+=1);return o.length>0?o:cn(t,e,n)}function un(t,e){if(0===e.length||0===t.length)return 0;return 1-hn(t,e,e.length)[0].errors/e.length}function dn(t,e,n={}){if(0===e.length)return null;const i=Math.min(256,e.length/2),o=hn(t,e,i);if(0===o.length)return null;const r=i=>{const o=1-i.errors/e.length,r=n.prefix?un(t.slice(Math.max(0,i.start-n.prefix.length),i.start),n.prefix):1,s=n.suffix?un(t.slice(i.end,i.end+n.suffix.length),n.suffix):1;let a=1;if("number"==typeof n.hint){a=1-Math.abs(i.start-n.hint)/t.length}return(50*o+20*r+20*s+2*a)/92},s=o.map((t=>({start:t.start,end:t.end,score:r(t)})));return s.sort(((t,e)=>e.score-t.score)),s[0]}function fn(t){const e=function(t){const e=t.nodeName.toLowerCase();let n=e;return"#text"===e&&(n="text()"),n}(t),n=function(t){let e=0,n=t;for(;n;)n.nodeName===t.nodeName&&(e+=1),n=n.previousSibling;return e}(t);return`${e}[${n}]`}function pn(t,e){let n="",i=t;for(;i!==e;){
if(!i)throw new Error("Node is not a descendant of root");n=fn(i)+"/"+n,i=i.parentNode}return n="/"+n,n=n.replace(/\/$/,""),n}function gn(t,e,n){e=e.toUpperCase();let i=-1;for(let o=0;o<t.children.length;o++){const r=t.children[o];if(r.nodeName.toUpperCase()===e&&(++i,i===n))return r}return null}function mn(t,e=document.body){try{return function(t,e){if(null===t.match(/^(\/[A-Za-z0-9-]+(\[[0-9]+\])?)+$/))throw new Error("Expression is not a simple XPath");const n=t.split("/");let i=e;n.shift();for(let t of n){let e,n;const o=t.indexOf("[");if(-1!==o){e=t.slice(0,o);const i=t.slice(o+1,t.indexOf("]"));if(n=parseInt(i)-1,n<0)return null}else e=t,n=0;const r=gn(i,e,n);if(!r)return null;i=r}return i}(t,e)}catch(n){return document.evaluate("."+t,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}}class _n{constructor(t,e){this.root=t,this.range=e}static fromRange(t,e){return new _n(t,e)}static fromSelector(t,e){const n=mn(e.startContainer,t)
;if(!n)throw new Error("Failed to resolve startContainer XPath");const i=mn(e.endContainer,t);if(!i)throw new Error("Failed to resolve endContainer XPath");const o=Oe.fromCharOffset(n,e.startOffset),r=Oe.fromCharOffset(i,e.endOffset),s=new Ie(o,r).toRange();return new _n(t,s)}toRange(){return this.range}selector(t){let e=t.tagName;return t.id&&(e+="#"+t.id),t.classList.forEach((t=>e+="."+t)),t.parentElement?this.selector(t.parentElement)+" > "+e:e}toSelector(){const t=Ie.fromRange(this.range).toRange(),e=Ie.fromRange(t),n=pn(e.start.element,this.root),i=pn(e.end.element,this.root);return{type:"RangeSelector",startContainer:n,startOffset:e.start.offset,endContainer:i,endOffset:e.end.offset,fullCssSelector:this.selector(e.start.element)}}}class vn{constructor(t,e,n){this.root=t,this.start=e,this.end=n}static fromRange(t,e){const n=Ie.fromRange(e).relativeTo(t);return new vn(t,n.start.offset,n.end.offset)}static fromSelector(t,e){return new vn(t,e.start,e.end)}toSelector(){return{type:"TextPositionSelector",
start:this.start,end:this.end}}toRange(){return Ie.fromOffsets(this.root,this.start,this.end).toRange()}}class yn{constructor(t,e,n={}){this.root=t,this.exact=e,this.context=n}static fromRange(t,e){const n=t.textContent,i=Ie.fromRange(e).relativeTo(t),o=i.start.offset,r=i.end.offset;return new yn(t,n.slice(o,r),{prefix:n.slice(Math.max(0,o-32),o),suffix:n.slice(r,Math.min(n.length,r+32))})}static fromSelector(t,e){const{prefix:n,suffix:i}=e;return new yn(t,e.exact,{prefix:n,suffix:i})}toSelector(){return{type:"TextQuoteSelector",exact:this.exact,prefix:this.context.prefix,suffix:this.context.suffix}}toRange(t={}){return this.toPositionAnchor(t).toRange()}toPositionAnchor(t={}){const e=dn(this.root.textContent,this.exact,{...this.context,hint:t.hint});if(!e)throw new Error("Quote not found");return new vn(this.root,e.start,e.end)}}async function bn(t,e={}){return t.toRange(e)}function wn(t,e,n={}){let i=null,o=null,r=null;for(let t of e)switch(t.type){case"TextPositionSelector":i=t,n.hint=i.start;break
;case"TextQuoteSelector":o=t;break;case"RangeSelector":r=t}const s=t=>{var e;if(null!==(e=o)&&void 0!==e&&e.exact&&t.toString()!==o.exact)throw new Error("quote mismatch");return t};let a=Promise.reject("unable to anchor");if(r){const e=r;a=a.catch((()=>bn(_n.fromSelector(t,e),n).then(s)))}if(i){const e=i;a=a.catch((()=>bn(vn.fromSelector(t,e),n).then(s)))}if(o){const e=o;a=a.catch((()=>bn(yn.fromSelector(t,e),n)))}return a}function Cn(t,e){const n=[_n,vn,yn],i=[];for(let o of n)try{const n=o.fromRange(t,e);i.push(n.toSelector())}catch(t){continue}return i}function xn(t,e=document.baseURI){return new URL(t,e).href.toString().replace(/#.*/,"")}class Sn{constructor(t={}){this.document=t.document||document}uri(){let t=decodeURIComponent(this._getDocumentHref());const e=this._getLinks();for(let n of e)"canonical"===n.rel&&(t=n.href);return t}getDocumentMetadata(){const t={title:document.title,link:[],dc:this._getMetaTags("name","dc."),eprints:this._getMetaTags("name","eprints."),
facebook:this._getMetaTags("property","og:"),highwire:this._getMetaTags("name","citation_"),prism:this._getMetaTags("name","prism."),twitter:this._getMetaTags("name","twitter:")},e=this._getFavicon();e&&(t.favicon=e),t.title=this._getTitle(t),t.link=this._getLinks(t);const n=t.link.find((t=>t.href.startsWith("urn:x-dc")));return n&&(t.documentFingerprint=n.href),t}_getMetaTags(t,e){const n={};for(let i of Array.from(this.document.querySelectorAll("meta"))){const o=i.getAttribute(t),{content:r}=i;if(o&&r){const t=o.match(RegExp(`^${e}(.+)$`,"i"));if(t){const e=t[1].toLowerCase();n[e]?n[e].push(r):n[e]=[r]}}}return n}_getTitle(t){return t.highwire.title?t.highwire.title[0]:t.eprints.title?t.eprints.title[0]:t.prism.title?t.prism.title[0]:t.facebook.title?t.facebook.title[0]:t.twitter.title?t.twitter.title[0]:t.dc.title?t.dc.title[0]:this.document.title}_getLinks(t={dc:{},highwire:{}}){const e=[{href:this._getDocumentHref()}],n=Array.from(this.document.querySelectorAll("link"))
;for(let t of n)if(["alternate","canonical","bookmark","shortlink"].includes(t.rel)){if("alternate"===t.rel){if(t.type&&t.type.match(/^application\/(rss|atom)\+xml/))continue;if(t.hreflang)continue}try{const n=this._absoluteUrl(t.href);e.push({href:n,rel:t.rel,type:t.type})}catch(t){}}for(let n of Object.keys(t.highwire)){const i=t.highwire[n];if("pdf_url"===n)for(let t of i)try{e.push({href:this._absoluteUrl(t),type:"application/pdf"})}catch(t){}if("doi"===n)for(let t of i)"doi:"!==t.slice(0,4)&&(t=`doi:${t}`),e.push({href:t})}for(let n of Object.keys(t.dc)){const i=t.dc[n];if("identifier"===n)for(let t of i)"doi:"===t.slice(0,4)&&e.push({href:t})}const i=t.dc["relation.ispartof"],o=t.dc.identifier;if(i&&o){const t=i[i.length-1],n=o[o.length-1],r="urn:x-dc:"+encodeURIComponent(t)+"/"+encodeURIComponent(n);e.push({href:r})}return e}_getFavicon(){let t=null;for(let e of Array.from(this.document.querySelectorAll("link")))if(["shortcut icon","icon"].includes(e.rel))try{t=this._absoluteUrl(e.href)}catch(t){}
return t}_absoluteUrl(t){return xn(t,this.document.baseURI)}_getDocumentHref(){const{href:t}=this.document.location,e=["http:","https:","file:"],n=new URL(t).protocol;return e.includes(n)?t:this.document.baseURI&&e.includes(new URL(this.document.baseURI).protocol)?this.document.baseURI:t}}function En(t){return t.width<=0||t.height<=0}function kn(t,e,n,i){return Math.max(t,n)<Math.min(e,i)}function Nn(t,e){return!En(t)&&!En(e)&&(kn(t.left,t.right,e.left,e.right)&&kn(t.top,t.bottom,e.top,e.bottom))}function An(t,e){return kn(t.top,t.bottom,e.top,e.bottom)}function Tn(t,e){return kn(t.left,t.right,e.left,e.right)}function Rn(t,e){if(En(t))return e;if(En(e))return t;const n=Math.min(t.left,e.left),i=Math.min(t.top,e.top),o=Math.max(t.right,e.right),r=Math.max(t.bottom,e.bottom);return new DOMRect(n,i,o-n,r-i)}function Ln(t){return new DOMPoint((t.left+t.right)/2,(t.top+t.bottom)/2)}const Pn=["p",".para"];let Mn;function On(t,e=0,n=t.data.length){return Mn||(Mn=document.createRange()),Mn.setStart(t,e),
Mn.setEnd(t,n),Mn.getBoundingClientRect()}function In(t){const e=t.getBoundingClientRect();return e.x-=t.scrollLeft,e.y-=t.scrollTop,e.height=Math.max(e.height,t.scrollHeight),e.width=Math.max(e.width,t.scrollWidth),e}function*Bn(t,e,n=(()=>!0)){let i=t.firstChild;for(;i;){if(i.nodeType===Node.ELEMENT_NODE){const t=i,o=Nn(In(t),e);n(t)&&o&&(yield*Bn(t,e,n))}else if(i.nodeType===Node.TEXT_NODE){const t=i;Nn(On(t),e)&&(yield t)}i=i.nextSibling}}function Fn(t,e){let n=null;const i=t=>!function(t){switch(getComputedStyle(t).position){case"fixed":case"sticky":return!0;default:return!1}}(t);t:for(let s of Bn(t,e,i)){let t=0;for(let i of s.data.split(/\b/)){if(/\S/.test(i)){const a=t,l=t+i.length,c=On(s,a,l);if(r=c,!En(o=e)&&!En(r)&&r.left>=o.left&&r.right<=o.right&&r.top>=o.top&&r.bottom<=o.bottom){n=document.createRange(),n.setStart(s,a),n.setEnd(s,l);break t}}t+=i.length}}var o,r;return n}function Hn(t,e=document.documentElement,n=new DOMRect(0,0,window.innerWidth,window.innerHeight)){const i=Fn(e,n)
;if(!i)return t(),0;const o=i.getBoundingClientRect().top;t();const r=i.getBoundingClientRect().top-o;return e.scrollTop+=r,r}function Dn(t,e,n){const i=t[e];if("function"!=typeof i)throw new Error("Can only intercept functions");return t[e]=(...e)=>{const o=i.call(t,...e);return n(...e),o},()=>{t[e]=i}}function Vn(t){return t.replace(/#.*/,"")}class qn{constructor(t,e=(()=>location.href)){this._listeners=new Ct;let n=e();const i=(i=e())=>{Vn(n)!==Vn(i)&&(n=i,t(i))},o=window.navigation;if(o)this._listeners.add(o,"navigatesuccess",(()=>i()));else{const t=[Dn(window.history,"pushState",(()=>i())),Dn(window.history,"replaceState",(()=>i()))];this._unpatchHistory=()=>t.forEach((t=>t())),this._listeners.add(window,"popstate",(()=>i()))}}disconnect(){var t;null===(t=this._unpatchHistory)||void 0===t||t.call(this),this._listeners.removeAll()}}var Un="complete",zn="canceled";function $n(t,e,n){t.self===t?t.scrollTo(e,n):(t.scrollLeft=e,t.scrollTop=n)}function Wn(t){var e=t._scrollSettings;if(e){
var n=e.maxSynchronousAlignments,i=function(t,e){var n,i,o,r,s,a,l,c=t.align,h=t.target.getBoundingClientRect(),u=c&&null!=c.left?c.left:.5,d=c&&null!=c.top?c.top:.5,f=c&&null!=c.leftOffset?c.leftOffset:0,p=c&&null!=c.topOffset?c.topOffset:0,g=u,m=d;if(t.isWindow(e))a=Math.min(h.width,e.innerWidth),l=Math.min(h.height,e.innerHeight),i=h.left+e.pageXOffset-e.innerWidth*g+a*g,o=h.top+e.pageYOffset-e.innerHeight*m+l*m,i-=f,o-=p,i=t.align.lockX?e.pageXOffset:i,o=t.align.lockY?e.pageYOffset:o,r=i-e.pageXOffset,s=o-e.pageYOffset;else{a=h.width,l=h.height,n=e.getBoundingClientRect();var _=h.left-(n.left-e.scrollLeft),v=h.top-(n.top-e.scrollTop);i=_+a*g-e.clientWidth*g,o=v+l*m-e.clientHeight*m,i-=f,o-=p,i=Math.max(Math.min(i,e.scrollWidth-e.clientWidth),0),o=Math.max(Math.min(o,e.scrollHeight-e.clientHeight),0),i=t.align.lockX?e.scrollLeft:i,o=t.align.lockY?e.scrollTop:o,r=i-e.scrollLeft,s=o-e.scrollTop}return{x:i,y:o,differenceX:r,differenceY:s}}(e,t),o=Date.now()-e.startTime,r=Math.min(1/e.time*o,1)
;if(e.endIterations>=n)return $n(t,i.x,i.y),t._scrollSettings=null,e.end(Un);var s=1-e.ease(r);if($n(t,i.x-i.differenceX*s,i.y-i.differenceY*s),o>=e.time)return e.endIterations++,e.scrollAncestor&&Wn(e.scrollAncestor),void Wn(t);!function(t){if("requestAnimationFrame"in window)return window.requestAnimationFrame(t);setTimeout(t,16)}(Wn.bind(null,t))}}function jn(t){return t.self===t}function Xn(t){return"pageXOffset"in t||(t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth)&&"hidden"!==getComputedStyle(t).overflow}function Yn(){return!0}function Zn(t){if(t.assignedSlot)return Zn(t.assignedSlot);if(t.parentElement)return"body"===t.parentElement.tagName.toLowerCase()?t.parentElement.ownerDocument.defaultView||t.parentElement.ownerDocument.ownerWindow:t.parentElement;if(t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e.host}}var Gn=function(t,e,n){if(t){"function"==typeof e&&(n=e,e=null),e||(e={}),e.time=isNaN(e.time)?1e3:e.time,e.ease=e.ease||function(t){return 1-Math.pow(1-t,t/2)},
e.align=e.align||{};var i=Zn(t),o=1,r=e.validTarget||Yn,s=e.isScrollable;e.debug&&(console.log("About to scroll to",t),i||console.error("Target did not have a parent, is it mounted in the DOM?"));for(var a=[];i;)if(e.debug&&console.log("Scrolling parent node",i),r(i,o)&&(s?s(i,Xn):Xn(i))&&(o++,a.push(i)),!(i=Zn(i))){l(Un);break}return a.reduce(((n,i,o)=>function(t,e,n,i,o){var r,s=!e._scrollSettings,a=e._scrollSettings,l=Date.now(),c={passive:!0};function h(t){e._scrollSettings=null,e.parentElement&&e.parentElement._scrollSettings&&e.parentElement._scrollSettings.end(t),n.debug&&console.log("Scrolling ended with type",t,"for",e),o(t),r&&(e.removeEventListener("touchstart",r,c),e.removeEventListener("wheel",r,c))}a&&a.end(zn);var u=n.maxSynchronousAlignments;return null==u&&(u=3),e._scrollSettings={startTime:l,endIterations:0,target:t,time:n.time,ease:n.ease,align:n.align,isWindow:n.isWindow||jn,maxSynchronousAlignments:u,end:h,scrollAncestor:i},"cancellable"in n&&!n.cancellable||(r=h.bind(null,zn),
e.addEventListener("touchstart",r,c),e.addEventListener("wheel",r,c)),s&&Wn(e),r}(t,i,e,a[o+1],l)),null)}function l(t){--o||n&&n(t)}};function Kn(t,e,n){return t+n*(e-t)}async function Qn(t,e,{maxDuration:n=500}={}){const i=t.scrollTop,o=e,r=Date.now(),s=Math.min(Math.abs(o-i)/3,n);let a=0;for(;a<1;)await new Promise((t=>{requestAnimationFrame(t)})),a=Math.min(1,(Date.now()-r)/s),t.scrollTop=Kn(i,o,a)}class Jn extends Rt{constructor({features:t,container:e=document.body}){super(),this.features=t,this.container=e,this.anchor=wn,this.describe=Cn,this._htmlMeta=new Sn,this._prevURI=this._htmlMeta.uri(),this._sideBySideEnabled=this.features.flagEnabled("html_side_by_side"),this._sideBySideActive=!1,this._lastLayout=null,this._navObserver=new qn((()=>this._checkForURIChange())),this._metaObserver=new MutationObserver((()=>this._checkForURIChange())),this._metaObserver.observe(document.head,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["rel","href","name","content"]}),this._flagsChanged=()=>{
const e=t.flagEnabled("html_side_by_side");e!==this._sideBySideEnabled&&(this._sideBySideEnabled=e,this._lastLayout&&this.fitSideBySide(this._lastLayout))},this.features.on("flagsChanged",this._flagsChanged)}_checkForURIChange(){const t=this._htmlMeta.uri();t!==this._prevURI&&(this._prevURI=t,this.emit("uriChanged",t))}canAnnotate(){return!0}canStyleClusteredHighlights(){return!0}destroy(){this._navObserver.disconnect(),this._metaObserver.disconnect(),this.features.off("flagsChanged",this._flagsChanged)}contentContainer(){return this.container}fitSideBySide(t){this._lastLayout=t;const e=window.innerWidth-t.width,n=this._sideBySideEnabled&&t.expanded&&e>=480;return n?this._activateSideBySide(t.width):this._sideBySideActive&&this._deactivateSideBySide(),this._sideBySideActive=n,n}_activateSideBySide(t){const e=t+12,n=t=>parseInt(window.getComputedStyle(t).marginLeft,10);Hn((()=>{document.body.style.marginLeft="",document.body.style.marginRight="";const t=n(document.body);document.body.style.marginRight=`${e}px`
;const i=function(t){const e=new Map,n=new Map,i=Pn.join(","),o=Array.from(t.querySelectorAll(i)).map((t=>({rect:t.getBoundingClientRect(),textLength:t.textContent.length}))).filter((({rect:t})=>t.width>0&&t.height>0)).sort(((t,e)=>e.textLength-t.textLength)).slice(0,15);if(o.forEach((({rect:t})=>{var i,o;let r=null!==(i=e.get(t.left))&&void 0!==i?i:0;r+=1,e.set(t.left,r);let s=null!==(o=n.get(t.right))&&void 0!==o?o:0;s+=1,n.set(t.right,s)})),0===e.size||0===n.size)return null;const r=[...e.entries()].sort(((t,e)=>e[1]-t[1])),s=[...n.entries()].sort(((t,e)=>e[1]-t[1])),[a]=r[0],[l]=s[0];return{left:a,right:l}}(document.body);if(i){const o=Math.max(0,window.innerWidth-e-i.right);if(o>0){const t=Math.max(0,e-o);document.body.style.marginRight=`${t}px`}n(document.body)>t&&(document.body.style.marginLeft=`${t}px`),i.left<12&&(document.body.style.marginLeft="12px")}else document.body.style.marginLeft="",document.body.style.marginRight=""}))}_deactivateSideBySide(){Hn((()=>{document.body.style.marginLeft="",
document.body.style.marginRight=""}))}async getMetadata(){return this._htmlMeta.getDocumentMetadata()}async uri(){return this._htmlMeta.uri()}async scrollToAnchor(t){var e;const n=null===(e=t.highlights)||void 0===e?void 0:e[0];n&&await async function(t,{maxDuration:e=500}={}){const n=t.closest("body");n&&"BODY"!==n.tagName&&Object.defineProperty(n,"tagName",{value:"BODY",configurable:!0}),await new Promise((n=>Gn(t,{time:e},n)))}(n)}}var ti=/^\s+|\s+$/g,ei=/^[-+]0x[0-9a-f]+$/i,ni=/^0b[01]+$/i,ii=/^0o[0-7]+$/i,oi=parseInt,ri="object"==typeof t&&t&&t.Object===Object&&t,si="object"==typeof self&&self&&self.Object===Object&&self,ai=ri||si||Function("return this")(),li=Object.prototype.toString,ci=Math.max,hi=Math.min,ui=function(){return ai.Date.now()};function di(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function fi(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==li.call(t)}(t))return NaN;if(di(t)){
var e="function"==typeof t.valueOf?t.valueOf():t;t=di(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ti,"");var n=ni.test(t);return n||ii.test(t)?oi(t.slice(2),n?2:8):ei.test(t)?NaN:+t}var pi=function(t,e,n){var i,o,r,s,a,l,c=0,h=!1,u=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var n=i,r=o;return i=o=void 0,c=e,s=t.apply(r,n)}function p(t){return c=t,a=setTimeout(m,e),h?f(t):s}function g(t){var n=t-l;return void 0===l||n>=e||n<0||u&&t-c>=r}function m(){var t=ui();if(g(t))return _(t);a=setTimeout(m,function(t){var n=e-(t-l);return u?hi(n,r-(t-c)):n}(t))}function _(t){return a=void 0,d&&i?f(t):(i=o=void 0,s)}function v(){var t=ui(),n=g(t);if(i=arguments,o=this,l=t,n){if(void 0===a)return p(l);if(u)return a=setTimeout(m,e),f(l)}return void 0===a&&(a=setTimeout(m,e)),s}return e=fi(e)||0,di(n)&&(h=!!n.leading,r=(u="maxWait"in n)?ci(fi(n.maxWait)||0,e):r,d="trailing"in n?!!n.trailing:d),v.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=o=a=void 0},
v.flush=function(){return void 0===a?s:_(ui())},v};function gi(t,e,n,i=0){let o=i;for(;o<t.length&&e>0;)n(t[o])&&--e,++o;return o}function mi(t,e,n,i){let o=0;for(let r=n;r<i;r++)e(t[r])&&++o;return o}function _i(t,e,n,i,o){const r=mi(t,o,0,n),s=mi(t,o,n,i);let a=gi(e,r,o);for(;a<e.length&&!o(e[a]);)++a;return[a,gi(e,s,o,a)]}const vi=0,yi=3,bi=new Map,wi=new Map;function Ci(t,e){return`${t}:${e}`}function xi(t){var e;const n="closest"in t?t:t.parentElement;return null!==(e=null==n?void 0:n.closest(".textLayer"))&&void 0!==e?e:null}function Si(){return PDFViewerApplication.pdfViewer}async function Ei(t){const e=Si();let n=e.getPageView(t);return n&&n.pdfPage||(n=await new Promise((n=>{const i=()=>{e.eventBus?e.eventBus.off("pagesloaded",i):document.removeEventListener("pagesloaded",i),n(e.getPageView(t))};e.eventBus?e.eventBus.on("pagesloaded",i):document.addEventListener("pagesloaded",i)}))),n}function ki(t){const e=bi.get(t);if(e)return e;const n=(async()=>{const e=await Ei(t)
;return(await e.pdfPage.getTextContent({normalizeWhitespace:!0})).items.map((t=>t.str)).join("")})();return bi.set(t,n),n}async function Ni(t){const e=Si();let n=0,i=0,o="";for(let r=0;r<e.pagesCount;r++)if(o=await ki(r),n=i,i+=o.length,i>=t)return{index:r,offset:n,text:o};return{index:e.pagesCount-1,offset:n,text:o}}function Ai(t){switch(t){case" ":case"\f":case"\n":case"\r":case"\t":case"\v":case"":return!0;default:return!1}}const Ti=t=>!Ai(t);async function Ri(t,e,n){const[i,o]=await Promise.all([Ei(t),ki(t)]);if(i.renderingState===yi&&i.textLayer&&i.textLayer.renderingDone){const t=i.textLayer.textLayerDiv,r=t.textContent,[s,a]=_i(o,r,e,n,Ti);Li(r.slice(s,a))!==Li(o.slice(e,n))&&en("Text layer text does not match page text. Highlights will be mis-aligned.");const l=new Oe(t,s),c=new Oe(t,a);return new Ie(l,c).toRange()}const r=function(t){let e=t.querySelector(Be);return e||(e=document.createElement("span"),e.classList.add("annotator-placeholder"),e.textContent="Loading annotations...",t.appendChild(e),
e)}(i.div),s=document.createRange();return s.setStartBefore(r),s.setEndAfter(r),s}function Li(t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Ai(i)||(e+=i)}return e}async function Pi(t,e){const n=e.find((t=>"TextQuoteSelector"===t.type));if(!n)throw new Error("No quote selector found");const i=e.find((t=>"TextPositionSelector"===t.type));if(i){try{const{index:t,offset:e,text:o}=await Ni(i.start),r=i.start-e,s=i.end-e,a=o.substring(r,s);if(n.exact!==a)throw new Error("quote mismatch");return await Ri(t,r,s)}catch{}try{const t=Ci(n.exact,i.start),e=wi.get(t);if(e){const{pageIndex:t,anchor:n}=e;return await Ri(t,n.start,n.end)}}catch{}}return async function(t,e){const n=Si().pagesCount,i=Array(n).fill(0).map(((t,e)=>e));let o,r;if(e){const{index:t,offset:n}=await Ni(e);o=t,r=e-n,i.sort(((e,n)=>Math.abs(e-t)-Math.abs(n-t)))}const s=void 0!==t.prefix?Li(t.prefix):void 0,a=void 0!==t.suffix?Li(t.suffix):void 0,l=Li(t.exact);let c;for(let t of i){const e=await ki(t),n=Li(e);let i
;void 0!==o&&void 0!==r&&(t<o?i=n.length:t===o?[i]=_i(e,n,r,r,Ti):i=0);const h=dn(n,l,{prefix:s,suffix:a,hint:i});if(h&&(!c||h.score>c.match.score)){const[i,o]=_i(n,e,h.start,h.end,Ti);c={page:t,match:{start:i,end:o,score:h.score}};const r=n.slice(h.start,h.end)===l,u=void 0!==s&&n.slice(Math.max(0,h.start-s.length),h.start)===s,d=void 0!==a&&n.slice(h.end,a.length)===a,f=void 0!==s||void 0!==a;if(r&&(u||d||!f))break}}if(c){const{page:n,match:i}=c;if(e){const o=Ci(t.exact,e);wi.set(o,{pageIndex:n,anchor:i})}return Ri(n,i.start,i.end)}throw new Error("Quote not found")}(n,null==i?void 0:i.start)}function Mi(t){try{t=Ie.fromRange(t).toRange()}catch{throw new Error("Selection does not contain text")}const e=xi(t.startContainer),n=xi(t.endContainer);if(!e||!n)throw new Error("Selection is outside page text");if(e!==n)throw new Error("Selecting across page breaks is not supported");return[t,e]}async function Oi(t,e){
const[n,i]=Mi(e),o=Oe.fromPoint(n.startContainer,n.startOffset).relativeTo(i),r=Oe.fromPoint(n.endContainer,n.endOffset).relativeTo(i),s=function(t){let e=0;for(;t.previousSibling;)++e,t=t.previousSibling;return e}(i.parentNode),a=await async function(t){if(t>=Si().pagesCount)throw new Error("Invalid page index");let e=0;for(let n=0;n<t;n++)e+=(await ki(n)).length;return e}(s);return[{type:"TextPositionSelector",start:a+o.offset,end:a+r.offset},yn.fromRange(t,n).toSelector()]}function Ii({children:t}){return ct("div",{className:"flex flex-col",children:t})}function Bi({info:t}){let e=t.item.title;return t.item.subtitle&&(e+=`: ${t.item.subtitle}`),ct("div",{className:c("h-10 bg-white px-4 text-slate-7 text-annotator-base border-b","grid items-center","grid-cols-[100px_minmax(0,auto)]","2xl:grid-cols-[100px_minmax(0,auto)_minmax(0,auto)] 2xl:gap-x-3"),children:[ct("div",{"data-testid":"content-logo",children:t.logo&&ct(we,{href:t.logo.link,target:"_blank","data-testid":"logo-link",children:ct("img",{
alt:t.logo.title,src:t.logo.logo,"data-testid":"logo-image"})})}),ct("div",{className:c("hidden","2xl:block 2xl:whitespace-nowrap 2xl:overflow-hidden 2xl:text-ellipsis","font-semibold"),"data-testid":"content-container-info",title:t.container.title,children:t.container.title}),ct("div",{className:c("flex justify-center items-center gap-x-2"),"data-testid":"content-item-info",children:[ct("div",{className:c("hidden","2xl:block 2xl:grow")}),t.links.previousItem&&ct(m,{children:[ct(we,{classes:"flex gap-x-1 items-center text-annotator-sm whitespace-nowrap",title:"Open previous item",href:t.links.previousItem,underline:"always",target:"_blank","data-testid":"content-previous-link",children:[ct(oe,{className:"w-em h-em"}),ct("span",{children:"Previous"})]}),ct("div",{className:"text-annotator-sm",children:"|"})]}),ct("div",{className:c("min-w-0 whitespace-nowrap overflow-hidden text-ellipsis shrink font-medium"),children:ct(be,{title:e,href:t.links.currentItem,"data-testid":"content-item-link",target:"_blank",
unstyled:!0,children:e})}),t.links.nextItem&&ct(m,{children:[ct("div",{className:"text-annotator-sm",children:"|"}),ct(we,{title:"Open next item",classes:"flex gap-x-1 items-center text-annotator-sm whitespace-nowrap",href:t.links.nextItem,underline:"always",target:"_blank","data-testid":"content-next-link",children:[ct("span",{children:"Next"}),ct(se,{className:"w-em h-em"})]})]})]})]})}function Fi(){return ct("div",{className:"bg-white",children:ct("div",{className:c("flex items-center gap-x-2","border border-yellow-notice bg-yellow-notice/10 text-annotator-base"),children:[ct("div",{className:"bg-yellow-notice text-white p-2",children:ct(vt,{name:"caution",classes:"text-annotator-xl"})}),ct("div",{children:[ct("strong",{children:"This PDF does not contain selectable text:"})," ",ct(yt,{target:"_blank",href:"https://web.hypothes.is/help/how-to-ocr-optimize-pdfs/",children:"Learn how to fix this"})," ","in order to annotate with Hypothesis."]})]})})}class Hi{constructor(t){this._loaded=function(t){
return t.initializedPromise?t.initializedPromise:t.initialized?Promise.resolve():new Promise((e=>{const n=setInterval((()=>{t.initialized&&(clearTimeout(n),e())}),5)}))}(t).then((()=>t.downloadComplete?t:new Promise((e=>{const n=()=>{t.eventBus?(t.eventBus.off("documentload",n),t.eventBus.off("documentloaded",n)):window.removeEventListener("documentload",n),e(t)};t.eventBus?(t.eventBus.on("documentloaded",n),t.eventBus.on("documentload",n)):window.addEventListener("documentload",n)}))))}getUri(){return this._loaded.then((t=>{let e=qi(t);return e||(e=Vi(Di(t))),e}))}async getMetadata(){const t=await this._loaded,{info:e,contentDispositionFilename:n,metadata:i}=await t.pdfDocument.getMetadata(),o=Di(t),r=qi(t);let s;s=null!=i&&i.has("dc:title")&&"Untitled"!==i.get("dc:title")?i.get("dc:title"):null!=e&&e.Title?e.Title:n||(r?function(t){const e=new URL(t).pathname.split("/");return e[e.length-1]}(r):"");const a=[{href:Vi(o)}];return r&&a.push({href:r}),{title:s,link:a,documentFingerprint:o}}}function Di(t){
return Array.isArray(t.pdfDocument.fingerprints)?t.pdfDocument.fingerprints[0]:t.pdfDocument.fingerprint}function Vi(t){return`urn:x-pdf:${t}`}function qi(t){if(!t.url)return null;const e=xn(t.url);return 0!==e.indexOf("file://")?e:null}function Ui(t){var e;const n=null===(e=t.highlights)||void 0===e?void 0:e[0];return n&&Fe(n)}function zi(t){return new Promise((e=>setTimeout(e,t)))}class $i extends Rt{constructor(t,e={}){var n,i,o;super(),this.annotator=t;const r=window,s=r.PDFViewerApplication;this.pdfViewer=s.pdfViewer,this.pdfViewer.viewer.classList.add("has-transparent-text-layer"),this.pdfContainer=null!==(n=null===(i=s.appConfig)||void 0===i?void 0:i.appContainer)&&void 0!==n?n:document.body,this.pdfMetadata=new Hi(s),this.observer=new MutationObserver(pi((()=>this._update()),100)),this.observer.observe(this.pdfViewer.viewer,{attributes:!0,attributeFilter:["data-loaded"],childList:!0,subtree:!0}),this._reanchoringMaxWait=null!==(o=e.reanchoringMaxWait)&&void 0!==o?o:3e3,this._banner=null,
this._bannerState={contentInfo:null,noTextWarning:!1},this._updateBannerState(this._bannerState),this._checkForSelectableText(),this._updateAnnotationLayerVisibility=()=>{const t=r.getSelection();this.pdfViewer.viewer.classList.toggle("is-selecting",!t.isCollapsed)},this._listeners=new Ct,this._listeners.add(document,"selectionchange",this._updateAnnotationLayerVisibility),this._destroyed=!1}destroy(){var t;this._listeners.removeAll(),this.pdfViewer.viewer.classList.remove("has-transparent-text-layer"),this.observer.disconnect(),null===(t=this._banner)||void 0===t||t.remove(),this._destroyed=!0}uri(){return this.pdfMetadata.getUri()}getMetadata(){return this.pdfMetadata.getMetadata()}showContentInfo(t){this._updateBannerState({contentInfo:t})}anchor(t,e){return Pi(0,e)}canAnnotate(t){return function(t){try{return Mi(t),!0}catch{return!1}}(t)}canStyleClusteredHighlights(){return!0}describe(t,e){return Oi(t,e)}async _checkForSelectableText(){try{await this.uri()}catch(t){return}if(!this._destroyed)try{
const t=await async function(){const t=Si();let e=!1;for(let n=0;n<t.pagesCount;n++)if((await ki(n)).trim().length>0){e=!0;break}return e}();this._updateBannerState({noTextWarning:!t})}catch(t){console.warn("Unable to check for text in PDF:",t)}}_updateBannerState(t){this._bannerState={...this._bannerState,...t};const e=document.querySelector("#outerContainer");var n;if(!(this._bannerState.contentInfo||this._bannerState.noTextWarning))return null===(n=this._banner)||void 0===n||n.remove(),this._banner=null,void(e.style.height="");this._banner||(this._banner=document.createElement("hypothesis-banner"),document.body.prepend(this._banner),Ae(this._banner)),I(ct(Ii,{children:[this._bannerState.contentInfo&&ct(Bi,{info:this._bannerState.contentInfo}),this._bannerState.noTextWarning&&ct(Fi,{})]}),this._banner.shadowRoot);const i=this._banner.getBoundingClientRect().height;e.style.height=`calc(100% - ${i}px)`}_update(){const t=[],e=this.pdfViewer.pagesCount;for(let t=0;t<e;t++){var n
;const e=this.pdfViewer.getPageView(t);if(null!=e&&null!==(n=e.textLayer)&&void 0!==n&&n.renderingDone)switch(e.renderingState){case vi:e.textLayer=null;break;case yi:i=e.div,o=void 0,null===(o=i.querySelector(Be))||void 0===o||o.remove()}}var i,o;for(let e of this.annotator.anchors)if(e.highlights){if(t.includes(e.annotation))continue;for(let n=0;n<e.highlights.length;n++){const i=e.highlights[n];if(!document.body.contains(i)){e.highlights.splice(n,1),delete e.range,t.push(e.annotation);break}}}t.map((t=>this.annotator.anchor(t)))}contentContainer(){return document.querySelector("#viewerContainer")}fitSideBySide(t){const e=window.innerWidth-t.width,n=t.expanded&&e>=680,i=n?t.width:t.toolbarWidth;this.pdfContainer.style.width=`calc(100% - ${i}px)`;const o=this.pdfViewer.currentScaleValue;return"auto"!==o&&"page-fit"!==o&&"page-width"!==o||(this.pdfViewer.currentScaleValue=o),this.pdfViewer.update(),n}async scrollToAnchor(t){const e=t.annotation,n=Ui(t),i=this._anchorOffset(t)
;if(null!==i&&(await Qn(this.contentContainer(),i),n)){const t=await this._waitForAnnotationToBeAnchored(e,this._reanchoringMaxWait);if(!t)return;const n=this._anchorOffset(t);if(null===n)return;await Qn(this.contentContainer(),n)}}async _waitForAnnotationToBeAnchored(t,e){var n;const i=Date.now();let o;do{o=this.annotator.anchors.find((e=>e.annotation===t)),o&&!Ui(o)||(o=null,await zi(20))}while(!o&&Date.now()-i<e);return null!==(n=o)&&void 0!==n?n:null}_anchorOffset(t){if(!t.highlights)return null;return function(t,e){let n=0;for(;t!==e&&e.contains(t);)n+=t.offsetTop,t=t.offsetParent;return n}(t.highlights[0],this.contentContainer())}}class Wi{constructor(t,e,n){this._element=t,this._onFrameAdded=e,this._onFrameRemoved=n,this._annotatableFrames=new Set,this._isDisconnected=!1,this._mutationObserver=new MutationObserver(pi((()=>{this._discoverFrames()}),40)),this._discoverFrames(),this._mutationObserver.observe(this._element,{childList:!0,subtree:!0,attributeFilter:["enable-annotation"]})}disconnect(){
this._isDisconnected=!0,this._mutationObserver.disconnect()}async _addFrame(t){this._annotatableFrames.add(t);try{if(await ji(t),this._isDisconnected)return;t.contentWindow.addEventListener("unload",(()=>{this._removeFrame(t)})),this._onFrameAdded(t)}catch(e){console.warn(`Unable to inject the Hypothesis client (from '${document.location.href}' into a cross-origin frame '${t.src}')`)}}_removeFrame(t){this._annotatableFrames.delete(t),this._onFrameRemoved(t)}_discoverFrames(){const t=new Set(this._element.querySelectorAll("iframe[enable-annotation]"));for(let e of t)this._annotatableFrames.has(e)||this._addFrame(e);for(let e of this._annotatableFrames)t.has(e)||this._removeFrame(e)}}function ji(t){return new Promise(((e,n)=>{const i=Xi(t,((t,o)=>{i(),o?e(o):n(t)}))}))}function Xi(t,e,{pollInterval:n=10}={}){let i,o;const r=new WeakSet,s=()=>{clearTimeout(i),i=void 0},a=()=>{const n=t.contentDocument;if(n){if(!r.has(n)){if(r.add(n),s(),!function(t){var e
;return"about:blank"===(null===(e=t.contentDocument)||void 0===e?void 0:e.location.href)&&t.hasAttribute("src")&&"about:blank"!==t.src}(t)){"interactive"===n.readyState||"complete"===n.readyState?e(null,n):n.addEventListener("DOMContentLoaded",(()=>e(null,n)))}var i;t.contentDocument&&(null===(i=t.contentWindow)||void 0===i||i.addEventListener("unload",o))}}else{s();const n=t.isConnected?"Frame is cross-origin":"Frame is disconnected";e(new Error(n))}};let l=!1;o=()=>{s(),l||(i=setInterval(a,n))},t.addEventListener("load",a);const c=setTimeout(a,0);return()=>{l=!0,clearTimeout(c),s(),t.removeEventListener("load",a)}}class Yi{constructor(t,e,n){if(e.length!==n.length)throw new Error("Char boxes length does not match text length");const i=t.parentNode,o=document.createElement("hypothesis-text-layer");i.insertBefore(o,t.nextSibling),i.style.position="relative",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.color="transparent",o.style.textAlign="left",o.style.mixBlendMode="multiply"
;const r="sans-serif";o.style.fontSize="16px",o.style.fontFamily=r;const s=document.createElement("canvas").getContext("2d");s.font="16px sans-serif";const a=(t,e,n="px")=>`calc(var(--${t}-scale) * ${e}${n})`,l=function(t,e){const n=[];let i={text:"",rect:new DOMRect};const o=()=>{i.text.length>0&&(n.push(i),i={text:"",rect:new DOMRect})};for(let[n,r]of t.entries()){const t=e[n],s=/\s/.test(t);i.rect=Rn(i.rect,r),i.text+=s?" ":t,s&&o()}o();const r=[];let s={words:[],rect:new DOMRect};const a=()=>{s.words.length>0&&(r.push(s),s={words:[],rect:new DOMRect})};for(let t of n){const e=s.words[s.words.length-1];if(e){const n=Ln(e.rect),i=Ln(t.rect).x-n.x;(!An(e.rect,t.rect)||i<0)&&a()}s.words.push(t),s.rect=Rn(s.rect,t.rect)}a();const l=[];let c={lines:[],rect:new DOMRect};const h=()=>{c.lines.length>0&&(l.push(c),c={lines:[],rect:new DOMRect})};for(let t of r){const e=c.lines[c.lines.length-1];if(e){const n=Ln(e.rect),i=Ln(t.rect).y-n.y;(!Tn(e.rect,t.rect)||An(e.rect,t.rect)||i<0||i>4*t.rect.height)&&h()}
c.lines.push(t),c.rect=Rn(c.rect,t.rect)}return h(),l}(e,n);for(let t of l){const e=document.createElement("hypothesis-text-column");e.style.display="block",e.style.position="absolute",e.style.left=a("x",t.rect.left),e.style.top=a("y",t.rect.top);let n=null;for(let i of t.lines){const o=document.createElement("hypothesis-text-line");o.style.display="block",o.style.marginLeft=a("x",i.rect.left-t.rect.left),o.style.height=a("y",i.rect.height),n&&(o.style.marginTop=a("y",i.rect.top-n.rect.bottom)),n=i,o.style.whiteSpace="nowrap";let r=null;for(let t of i.words){const e=document.createElement("hypothesis-text-word");e.style.display="inline-block",e.style.transformOrigin="top left",e.textContent=t.text,r&&(e.style.marginLeft=a("x",t.rect.left-r.rect.right)),r=t,e.style.width=a("x",t.rect.width),e.style.height=a("y",t.rect.height),e.style.whiteSpace="pre";const n=s.measureText(t.text),i=a("x",t.rect.width/n.width,""),l=a("y",t.rect.height/16,"");e.style.transform=`scale(${i}, ${l})`,o.append(e)}e.append(o)}
o.append(e)}const c=()=>{const{width:e,height:n}=t.getBoundingClientRect();o.style.width=e+"px",o.style.height=n+"px",o.style.setProperty("--x-scale",`${e}`),o.style.setProperty("--y-scale",`${n}`)};c(),this.container=o,this._updateTextLayerSize=pi(c,{maxWait:50}),this._listeners=new Ct,"undefined"!=typeof ResizeObserver&&(this._imageSizeObserver=new ResizeObserver((()=>{this._updateTextLayerSize()})),this._imageSizeObserver.observe(t)),this._listeners.add(window,"resize",this._updateTextLayerSize)}updateSync(){this._updateTextLayerSize(),this._updateTextLayerSize.flush()}destroy(){var t;this.container.remove(),this._listeners.removeAll(),this._updateTextLayerSize.cancel(),null===(t=this._imageSizeObserver)||void 0===t||t.disconnect()}}class Zi{constructor(t,e){this._config=e,this._frameObserver=new Wi(t,(t=>Gi(t,e)),(()=>{}))}destroy(){this._frameObserver.disconnect()}}async function Gi(t,e,n){if(null!==t.contentDocument.querySelector("script.js-hypothesis-config"))return;await ji(t)
;const{assetRoot:i,notebookAppUrl:o,sidebarAppUrl:r}=Ut(document),s={...e,assetRoot:i,notebookAppUrl:o,sidebarAppUrl:r,subFrameIdentifier:null!=n?n:St(10)},a=document.createElement("script");a.className="js-hypothesis-config",a.type="application/json",a.innerText=JSON.stringify(s);const l=document.createElement("script");l.async=!0,l.src=e.clientUrl;const c=t.contentDocument;c.body.appendChild(a),c.body.appendChild(l)}function Ki(t=document){return t.querySelector("mosaic-book")}function Qi(t=window){var e;if(Ki(t.document))return"container";const n=null===(e=t.frameElement)||void 0===e?void 0:e.ownerDocument;return n&&Ki(n)?"content":null}class Ji{constructor(t){wt(this,"_frameObserver",void 0);const e=Ki();if(!e)throw new Error("Book container element not found");const n=new WeakSet,i=e.shadowRoot,o=()=>{const e=i.querySelector("iframe");e&&!n.has(e)&&(n.add(e),Xi(e,((n,i)=>{if(n)return;const o=i.body;o&&!o.querySelector("#page-content")&&Gi(e,t,"vitalsource-content")})))};o(),
this._frameObserver=new MutationObserver(o),this._frameObserver.observe(i,{childList:!0,subtree:!0})}destroy(){this._frameObserver.disconnect()}}function to(){return document.querySelector("img#pbk-page")}class eo extends Rt{constructor(t=document.body,e){var n;super(),wt(this,"_bookElement",void 0),wt(this,"_features",void 0),wt(this,"_htmlIntegration",void 0),wt(this,"_listeners",void 0),wt(this,"_textLayer",void 0),this._features=e.features;const i=null!==(n=e.bookElement)&&void 0!==n?n:Ki(window.parent.document);if(!i)throw new Error("Failed to find <mosaic-book> element in container frame");this._bookElement=i,this._features.on("flagsChanged",(()=>{this.emit("uriChanged")}));const o=new on;o.update({html_side_by_side:!0}),this._htmlIntegration=new Jn({container:t,features:o}),this._listeners=new Ct;const r=["mouseup","mousedown","mouseout"];for(const t of r)this._listeners.add(document.documentElement,t,(t=>{t.stopPropagation()}));const s=window.frameElement;s&&function(t){
if("no"!==t.getAttribute("scrolling"))return;const e=document.createElement("style");e.textContent="iframe { height: 100% !important; }",t.insertAdjacentElement("beforebegin",e);const n=()=>t.removeAttribute("scrolling");n(),new MutationObserver(n).observe(t,{attributes:!0})}(s);const a=to(),l=window.innerPageData;if(a&&l){const t=l.glyphs.glyphs.map((t=>{const e=t.l/100,n=t.r/100,i=t.t/100,o=t.b/100;return new DOMRect(e,i,n-e,o-i)}));this._textLayer=new Yi(a,t,l.words),this._textLayer.container.style.zIndex="100"}}canAnnotate(){return!0}destroy(){var t;null===(t=this._textLayer)||void 0===t||t.destroy(),this._listeners.removeAll(),this._htmlIntegration.destroy()}anchor(t,e){return this._htmlIntegration.anchor(t,e)}async describe(t,e){const n=this._htmlIntegration.describe(t,e);if(!this._bookIsSingleDocument())return n;const i=await this._bookElement.getCurrentPage(),o=[{type:"EPUBContentSelector",cfi:i.cfi,url:i.absoluteURL,title:i.chapterTitle}];return"pbk"===this._bookElement.getBookInfo().format&&o.push({
type:"PageSelector",index:i.index,label:i.page}),n.push(...o),n}contentContainer(){return this._htmlIntegration.contentContainer()}fitSideBySide(t){const e=to();if(e&&this._textLayer){const n=e.parentElement,i=this._textLayer,o=window.innerWidth-t.width;return Hn((()=>{t.expanded&&o>480?(n.style.textAlign="left",e.style.width=`${o}px`):(n.style.textAlign="",e.style.width=""),i.updateSync()})),t.expanded}return this._htmlIntegration.fitSideBySide(t)}async getMetadata(){if(this._bookIsSingleDocument()){return{title:this._bookElement.getBookInfo().title,link:[]}}return{title:document.title,link:[]}}navigateToSegment(t){var e;const n=null===(e=t.target[0].selector)||void 0===e?void 0:e.find((t=>"EPUBContentSelector"===t.type));if(null!=n&&n.cfi)this._bookElement.goToCfi(n.cfi);else{if(null==n||!n.url)throw new Error("No segment information available");this._bookElement.goToURL(n.url)}}persistFrame(){return!0}async segmentInfo(){const t=await this._bookElement.getCurrentPage();return{cfi:t.cfi,url:t.absoluteURL}}
async uri(){if(this._bookIsSingleDocument()){return`https://bookshelf.vitalsource.com/reader/books/${this._bookElement.getBookInfo().isbn}`}const t=new URL(document.location.href);return t.search="",t.toString()}async scrollToAnchor(t){return this._htmlIntegration.scrollToAnchor(t)}_bookIsSingleDocument(){return this._features.flagEnabled("book_as_single_document")}waitForFeatureFlags(){return!0}}function no(t){if("undefined"!=typeof PDFViewerApplication)return new $i(t);return"content"===Qi()?new eo(document.body,{features:t.features}):new Jn({features:t.features})}function io(t){const e=t.getSelection();if(!e||0===e.rangeCount)return null;const n=e.getRangeAt(0);return n.collapsed?null:n}class oo{constructor(t,e=document){let n=!1;this._pendingCallback=null;const i=(n=10)=>{this._pendingCallback=setTimeout((()=>{t(io(e))}),n)},o=t=>{if("mousedown"===t.type&&(n=!0),"mouseup"===t.type&&(n=!1),n)return;this._cancelPendingCallback();const e="mouseup"===t.type?10:100;i(e)};this._document=e,
this._listeners=new Ct,this._listeners.add(e,"selectionchange",o),this._listeners.add(e.body,"mousedown",o),this._listeners.add(e.body,"mouseup",o),i(1)}disconnect(){this._listeners.removeAll(),this._cancelPendingCallback()}_cancelPendingCallback(){this._pendingCallback&&(clearTimeout(this._pendingCallback),this._pendingCallback=null)}}function ro(){const t=function(t,e){const n=new Set,i=new Set;return Ve(t,(t=>{let o=t;for(;o&&!n.has(o);){n.add(o);const t=e(o);null!=t&&i.add(t),o=o.parentNode}})),[...i]}(window.getSelection().getRangeAt(0),(t=>{var e;return null===(e=t._annotation)||void 0===e?void 0:e.$tag}));return t}function so(t){const e=function(t){let e=t.nodeType===Node.ELEMENT_NODE?t:t.parentElement;const n=[];for(;e;)e.classList.contains("hypothesis-highlight")&&n.push(e),e=e.parentElement;return n}(t).map((t=>t._annotation)).filter((t=>void 0!==t)).map((t=>null==t?void 0:t.$tag));return e}function ao(t){if(!t.range)return null;try{return t.range.toRange()}catch{return null}}function lo(){var t
;null===(t=document.getSelection())||void 0===t||t.removeAllRanges()}class co{constructor(t,e={},n=window){var i,o,r,s,a;(wt(this,"element",void 0),wt(this,"selectedRanges",void 0),wt(this,"anchors",void 0),wt(this,"features",void 0),wt(this,"_featureFlagsReceived",void 0),wt(this,"_adder",void 0),wt(this,"_clusterToolbar",void 0),wt(this,"_hostFrame",void 0),wt(this,"_highlightsVisible",void 0),wt(this,"_isAdderVisible",void 0),wt(this,"_informHostOnNextSelectionClear",void 0),wt(this,"_selectionObserver",void 0),wt(this,"_annotations",void 0),wt(this,"_frameIdentifier",void 0),wt(this,"_portFinder",void 0),wt(this,"_integration",void 0),wt(this,"_hostRPC",void 0),wt(this,"_sidebarRPC",void 0),wt(this,"_bucketBarClient",void 0),wt(this,"_sideBySideActive",void 0),wt(this,"_listeners",void 0),wt(this,"_hoveredAnnotations",void 0),this.element=t,this._hostFrame=n,this._highlightsVisible=!1,this._isAdderVisible=!1,this._informHostOnNextSelectionClear=!0,this.selectedRanges=[],this._adder=new Re(this.element,{
onAnnotate:()=>this.createAnnotation(),onHighlight:()=>this.createAnnotation({highlight:!0}),onShowAnnotations:t=>this.selectAnnotations(t,{focusInSidebar:!0})}),this._selectionObserver=new oo((t=>{t?this._onSelection(t):this._onClearSelection()})),this.anchors=[],this._annotations=new Set,this._frameIdentifier=e.subFrameIdentifier||null,this._portFinder=new Nt({hostFrame:this._hostFrame,source:"guest",sourceId:null!==(i=this._frameIdentifier)&&void 0!==i?i:void 0}),this.features=new on,this._featureFlagsReceived=new Promise((t=>{this.features.on("flagsChanged",t)})),this._integration=no(this),this._integration.on("uriChanged",(()=>this._sendDocumentInfo())),e.contentInfoBanner)&&(null===(s=(a=this._integration).showContentInfo)||void 0===s||s.call(a,e.contentInfoBanner));null!==(o=(r=this._integration).canStyleClusteredHighlights)&&void 0!==o&&o.call(r)&&(this._clusterToolbar=new Je(this._integration.contentContainer(),{features:this.features})),this._hostRPC=new Vt,this._connectHost(n),
this._sidebarRPC=new Vt,this._connectSidebar(),this._bucketBarClient=new Ye({contentContainer:this._integration.contentContainer(),hostRPC:this._hostRPC}),this._sideBySideActive=!1,this._listeners=new Ct,this._setupElementEvents(),this._hoveredAnnotations=new Set}_setupElementEvents(){const t=t=>{this._sideBySideActive||so(t).length||this._sidebarRPC.call("closeSidebar")};this._listeners.add(this.element,"mouseup",(t=>{const{target:e,metaKey:n,ctrlKey:i}=t,o=so(e);if(o.length&&this._highlightsVisible){const t=n||i;this.selectAnnotations(o,{toggle:t})}})),this._listeners.add(this.element,"mousedown",(({target:e})=>{t(e)})),this._listeners.add(this.element,"touchstart",(({target:e})=>{t(e)})),this._listeners.add(this.element,"mouseover",(({target:t})=>{const e=so(t);e.length&&this._highlightsVisible&&this._sidebarRPC.call("hoverAnnotations",e)})),this._listeners.add(this.element,"mouseout",(()=>{this._highlightsVisible&&this._sidebarRPC.call("hoverAnnotations",[])})),
this._listeners.add(this.element,"keydown",(t=>{this._handleShortcut(t)})),this._listeners.add(window,"resize",(()=>this._repositionAdder()))}async getDocumentInfo(){var t,e,n,i,o;const[r,s,a]=await Promise.all([this._integration.uri(),this._integration.getMetadata(),null===(t=(e=this._integration).segmentInfo)||void 0===t?void 0:t.call(e)]);return{uri:xn(r),metadata:s,segmentInfo:a,persistent:null!==(n=null===(i=(o=this._integration).persistFrame)||void 0===i?void 0:i.call(o))&&void 0!==n&&n}}async _sendDocumentInfo(){var t,e;null!==(t=(e=this._integration).waitForFeatureFlags)&&void 0!==t&&t.call(e)&&await this._featureFlagsReceived;const n=await this.getDocumentInfo();this._sidebarRPC.call("documentInfoChanged",n)}_repositionAdder(){var t;if(!1===this._isAdderVisible)return;const e=null===(t=window.getSelection())||void 0===t?void 0:t.getRangeAt(0);e&&this._onSelection(e)}async _connectHost(t){this._hostRPC.on("clearSelection",(()=>{io(document)&&(this._informHostOnNextSelectionClear=!1,lo())})),
this._hostRPC.on("createAnnotation",(()=>this.createAnnotation())),this._hostRPC.on("hoverAnnotations",(t=>this._hoverAnnotations(t))),this._hostRPC.on("scrollToClosestOffScreenAnchor",((t,e)=>this._scrollToClosestOffScreenAnchor(t,e))),this._hostRPC.on("selectAnnotations",((t,e)=>this.selectAnnotations(t,{toggle:e}))),this._hostRPC.on("sidebarLayoutChanged",(e=>{var n,i;((n=window)===(i=t)||n.parent===i&&n.frameElement&&n.frameElement.getBoundingClientRect().width/n.parent.innerWidth>=.8)&&this.fitSideBySide(e)}));const e=await this._portFinder.discover("host");this._hostRPC.connect(e)}async _connectSidebar(){this._sidebarRPC.on("featureFlagsUpdated",(t=>this.features.update(t))),this._sidebarRPC.on("hoverAnnotations",(t=>this._hoverAnnotations(t))),this._sidebarRPC.on("scrollToAnnotation",(t=>{const e=this.anchors.find((e=>e.annotation.$tag===t));if(null==e||!e.highlights)return;const n=ao(e);if(!n)return;const i=new CustomEvent("scrolltorange",{bubbles:!0,cancelable:!0,detail:n})
;this.element.dispatchEvent(i)&&this._integration.scrollToAnchor(e)})),this._sidebarRPC.on("setHighlightsVisible",(t=>{this.setHighlightsVisible(t,!1)})),this._sidebarRPC.on("deleteAnnotation",(t=>this.detach(t))),this._sidebarRPC.on("loadAnnotations",(t=>t.forEach((t=>this.anchor(t))))),this._sidebarRPC.on("showContentInfo",(t=>{var e,n;return null===(e=(n=this._integration).showContentInfo)||void 0===e?void 0:e.call(n,t)})),this._sidebarRPC.on("navigateToSegment",(t=>{var e,n;return null===(e=(n=this._integration).navigateToSegment)||void 0===e?void 0:e.call(n,t)})),this._portFinder.discover("sidebar").then((t=>{this._sidebarRPC.connect(t)})),this._sendDocumentInfo()}destroy(){var t;this._portFinder.destroy(),this._hostRPC.destroy(),this._sidebarRPC.destroy(),this._listeners.removeAll(),this._selectionObserver.disconnect(),this._adder.destroy(),this._bucketBarClient.destroy(),null===(t=this._clusterToolbar)||void 0===t||t.destroy(),function(t){We(Array.from(t.querySelectorAll("hypothesis-highlight")))
}(this.element),this._integration.destroy()}async anchor(t){const e=t=>{var e;const n=ao(t);if(!n)return;const i=ze(n,null===(e=t.annotation)||void 0===e?void 0:e.$cluster);i.forEach((e=>{e._annotation=t.annotation})),t.highlights=i,this._hoveredAnnotations.has(t.annotation.$tag)&&je(i,!0)};this.detach(t.$tag,!1),this._annotations.add(t.$tag),t.target||(t.target=[]);const n=await Promise.all(t.target.map((async e=>{if(!e.selector||!e.selector.some((t=>"TextQuoteSelector"===t.type)))return{annotation:t,target:e};let n;try{const i=await this._integration.anchor(this.element,e.selector),o=Ie.fromRange(i);n={annotation:t,target:e,range:o}}catch(i){n={annotation:t,target:e}}return n})));if(!this._annotations.has(t.$tag))return[];for(const t of n)e(t);return t.$orphan=n.length>0&&n.every((t=>t.target.selector&&!t.range)),this._updateAnchors(this.anchors.concat(n),!0),this._sidebarRPC.call("syncAnchoringStatus",t),n}detach(t,e=!0){this._annotations.delete(t);const n=[]
;for(const e of this.anchors)e.annotation.$tag!==t?n.push(e):e.highlights&&We(e.highlights);this._updateAnchors(n,e)}_updateAnchors(t,e){this.anchors=t,e&&this._bucketBarClient.update(this.anchors)}async createAnnotation({highlight:t=!1}={}){const e=this.selectedRanges;this.selectedRanges=[];const n=await this.getDocumentInfo(),i=this.element,o=(await Promise.all(e.map((t=>this._integration.describe(i,t))))).map((t=>({source:n.uri,selector:t}))),r={uri:n.uri,document:n.metadata,target:o,$highlight:t,$cluster:t?"user-highlights":"user-annotations",$tag:"a:"+St(8)};return this._sidebarRPC.call("createAnnotation",r),this.anchor(r),lo(),r}_hoverAnnotations(t){this._hoveredAnnotations.clear(),t.forEach((t=>this._hoveredAnnotations.add(t)));for(const e of this.anchors)if(e.highlights){const n=t.includes(e.annotation.$tag);je(e.highlights,n)}this._sidebarRPC.call("hoverAnnotations",t)}_scrollToClosestOffScreenAnchor(t,e){const n=function(t,e){let n=null,i=0;for(let r of t){var o
;if(null===(o=r.highlights)||void 0===o||!o.length)continue;const t=Xe(r.highlights).top;"up"===e&&t>=137||"down"===e&&t<=window.innerHeight-22||(!n||"up"===e&&t>i||"down"===e&&t<i)&&(n=r,i=t)}return n}(this.anchors.filter((({annotation:e})=>t.includes(e.$tag))),e);n&&this._integration.scrollToAnchor(n)}_onSelection(t){if(!this._integration.canAnnotate(t))return void this._onClearSelection();const e=document.getSelection(),n=He(e),i=qe(e);i?(this.selectedRanges=[t],this._hostRPC.call("textSelected"),this._adder.annotationsForSelection=ro(),this._isAdderVisible=!0,this._adder.show(i,n)):this._onClearSelection()}_onClearSelection(){this._isAdderVisible=!1,this._adder.hide(),this.selectedRanges=[],this._informHostOnNextSelectionClear&&this._hostRPC.call("textUnselected"),this._informHostOnNextSelectionClear=!0}selectAnnotations(t,{toggle:e=!1,focusInSidebar:n=!1}={}){e?this._sidebarRPC.call("toggleAnnotationSelection",t):this._sidebarRPC.call("showAnnotations",t,n),this._sidebarRPC.call("openSidebar")}
setHighlightsVisible(t,e=!0){!function(t,e){t.classList.toggle("hypothesis-highlights-always-on",e)}(this.element,t),this._highlightsVisible=t,e&&this._hostRPC.call("highlightsVisibleChanged",t)}get highlightsVisible(){return this._highlightsVisible}fitSideBySide(t){this._sideBySideActive=this._integration.fitSideBySide(t)}get sideBySideActive(){return this._sideBySideActive}get hoveredAnnotationTags(){return this._hoveredAnnotations}_handleShortcut(t){Kt(t,"Ctrl+Shift+H")&&this.setHighlightsVisible(!this._highlightsVisible)}}function ho(t,e){const n=new URL(t),i=new URLSearchParams;return i.append("config",JSON.stringify(e)),n.hash=i.toString(),n.toString()}function uo(t,e){var n;const i={};for(let[t,n]of Object.entries(e))"notebookAppUrl"!==t&&"sidebarAppUrl"!==t&&null!=n&&(i[t]=n);i.origin=new URL(t).origin,i.version="1.0.0-dummy-version";const o=new URL(window.location.href);if(o.hash="",i.hostURL=o.toString(),Array.isArray(i.services)&&(null===(n=i.services)||void 0===n?void 0:n.length)>0){
const t=i.services[0];t.onLoginRequest&&(t.onLoginRequestProvided=!0),t.onLogoutRequest&&(t.onLogoutRequestProvided=!0),t.onSignupRequest&&(t.onSignupRequestProvided=!0),t.onProfileRequest&&(t.onProfileRequestProvided=!0),t.onHelpRequest&&(t.onHelpRequestProvided=!0)}return i}function fo({config:t,groupId:e}){return ct("iframe",{title:"Hypothesis annotation notebook",className:"h-full w-full border-0",allowFullScreen:!0,src:ho(t.notebookAppUrl,{...uo(t.notebookAppUrl,t),group:e})})}function po({eventBus:t,config:e}){const[n,i]=G(0),[o,r]=G(!0),[s,a]=G(null),l=J(""),h=J(null);K((()=>(l.current=document.body.style.overflow,()=>{document.body.style.overflow=l.current})),[]),K((()=>{document.body.style.overflow=o?l.current:"hidden"}),[o]),K((()=>{const e=t.createEmitter();return e.subscribe("openNotebook",(t=>{r(!1),i((t=>t+1)),a(t)})),h.current=e,()=>{e.destroy()}}),[t]);return null===s?null:ct("div",{className:c("fixed z-max top-0 left-0 right-0 bottom-0 p-3 bg-black/50",{hidden:o}),
"data-testid":"notebook-outer",children:ct("div",{className:"relative w-full h-full","data-testid":"notebook-inner",children:[ct("div",{className:"absolute right-0 text-xl m-3",children:ct(gt,{icon:"cancel",title:"Close the Notebook",onClick:()=>{var t;r(!0),null===(t=h.current)||void 0===t||t.publish("closeNotebook")},variant:"dark"})}),ct(fo,{config:e,groupId:s},n)]})})}class go{constructor(t,e,n){this._outerContainer=document.createElement("hypothesis-notebook"),t.appendChild(this._outerContainer),this.shadowRoot=Ae(this._outerContainer),I(ct(po,{eventBus:e,config:n}),this.shadowRoot)}destroy(){I(null,this.shadowRoot),this._outerContainer.remove()}}var mo={exports:{}};!function(t){!function(e,n,i,o){var r,s=["","webkit","Moz","MS","ms","o"],a=n.createElement("div"),l=Math.round,c=Math.abs,h=Date.now;function u(t,e,n){return setTimeout(v(t,n),e)}function d(t,e,n){return!!Array.isArray(t)&&(f(t,n[e],n),!0)}function f(t,e,n){var i
;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==o)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function p(t,n,i){var o="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=e.console&&(e.console.warn||e.console.log);return r&&r.call(e.console,o,i),t.apply(this,arguments)}}r="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==o&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var g=p((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===o)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),m=p((function(t,e){return g(t,e,!0)
}),"merge","Use `assign`.");function _(t,e,n){var i,o=e.prototype;(i=t.prototype=Object.create(o)).constructor=t,i._super=o,n&&r(i,n)}function v(t,e){return function(){return t.apply(e,arguments)}}function y(t,e){return"function"==typeof t?t.apply(e&&e[0]||o,e):t}function b(t,e){return t===o?e:t}function w(t,e,n){f(E(e),(function(e){t.addEventListener(e,n,!1)}))}function C(t,e,n){f(E(e),(function(e){t.removeEventListener(e,n,!1)}))}function x(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function S(t,e){return t.indexOf(e)>-1}function E(t){return t.trim().split(/\s+/g)}function k(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function N(t){return Array.prototype.slice.call(t,0)}function A(t,e,n){for(var i=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];k(o,s)<0&&i.push(t[r]),o[r]=s,r++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function T(t,e){
for(var n,i,r=e[0].toUpperCase()+e.slice(1),a=0;a<s.length;){if((i=(n=s[a])?n+r:e)in t)return i;a++}return o}var R=1;function L(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var P="ontouchstart"in e,M=T(e,"PointerEvent")!==o,O=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),I="touch",B="mouse",F=24,H=["x","y"],D=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){y(t.options.enable,[t])&&n.handler(e)},this.init()}function q(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,s=1&e&&i-r==0,a=12&e&&i-r==0;n.isFirst=!!s,n.isFinal=!!a,s&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=U(e));r>1&&!n.firstMultiple?n.firstMultiple=U(e):1===r&&(n.firstMultiple=!1);var s=n.firstInput,a=n.firstMultiple,l=a?a.center:s.center,u=e.center=z(i);e.timeStamp=h(),e.deltaTime=e.timeStamp-s.timeStamp,
e.angle=X(l,u),e.distance=j(l,u),function(t,e){var n=e.center,i=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=o.x+(n.x-i.x),e.deltaY=o.y+(n.y-i.y)}(n,e),e.offsetDirection=W(e.deltaX,e.deltaY);var d=$(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=c(d.x)>c(d.y)?d.x:d.y,e.scale=a?(f=a.pointers,p=i,j(p[0],p[1],D)/j(f[0],f[1],D)):1,e.rotation=a?function(t,e){return X(e[1],e[0],D)+X(t[1],t[0],D)}(a.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,s,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(l>25||a.velocity===o)){var h=e.deltaX-a.deltaX,u=e.deltaY-a.deltaY,d=$(l,h,u);i=d.x,r=d.y,n=c(d.x)>c(d.y)?d.x:d.y,s=W(h,u),t.lastInterval=e}else n=a.velocity,i=a.velocityX,r=a.velocityY,s=a.direction;e.velocity=n,
e.velocityX=i,e.velocityY=r,e.direction=s}(n,e);var f,p;var g=t.element;x(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function U(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:l(t.pointers[n].clientX),clientY:l(t.pointers[n].clientY)},n++;return{timeStamp:h(),pointers:e,center:z(e),deltaX:t.deltaX,deltaY:t.deltaY}}function z(t){var e=t.length;if(1===e)return{x:l(t[0].clientX),y:l(t[0].clientY)};for(var n=0,i=0,o=0;o<e;)n+=t[o].clientX,i+=t[o].clientY,o++;return{x:l(n/e),y:l(i/e)}}function $(t,e,n){return{x:e/t||0,y:n/t||0}}function W(t,e){return t===e?1:c(t)>=c(e)?t<0?2:4:e<0?8:16}function j(t,e,n){n||(n=H);var i=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return Math.sqrt(i*i+o*o)}function X(t,e,n){n||(n=H);var i=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return 180*Math.atan2(o,i)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),
this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(L(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4},Z="mousedown",G="mousemove mouseup";function K(){this.evEl=Z,this.evWin=G,this.pressed=!1,V.apply(this,arguments)}_(K,V,{handler:function(t){var e=Y[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:B,srcEvent:t}))}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},J={2:I,3:"pen",4:B,5:"kinect"},tt="pointerdown",et="pointermove pointerup pointercancel";function nt(){this.evEl=tt,this.evWin=et,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}
e.MSPointerEvent&&!e.PointerEvent&&(tt="MSPointerDown",et="MSPointerMove MSPointerUp MSPointerCancel"),_(nt,V,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),o=Q[i],r=J[t.pointerType]||t.pointerType,s=r==I,a=k(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),n&&e.splice(a,1))}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ot="touchstart",rt="touchstart touchmove touchend touchcancel";function st(){this.evTarget=ot,this.evWin=rt,this.started=!1,V.apply(this,arguments)}function at(t,e){var n=N(t.touches),i=N(t.changedTouches);return 12&e&&(n=A(n.concat(i),"identifier",!0)),[n,i]}_(st,V,{handler:function(t){var e=it[t.type];if(1===e&&(this.started=!0),this.started){var n=at.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:I,
srcEvent:t})}}});var lt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ct="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=ct,this.targetIds={},V.apply(this,arguments)}function ut(t,e){var n=N(t.touches),i=this.targetIds;if(3&e&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,r,s=N(t.changedTouches),a=[],l=this.target;if(r=n.filter((function(t){return x(t.target,l)})),1===e)for(o=0;o<r.length;)i[r[o].identifier]=!0,o++;for(o=0;o<s.length;)i[s[o].identifier]&&a.push(s[o]),12&e&&delete i[s[o].identifier],o++;return a.length?[A(r.concat(a),"identifier",!0),a]:void 0}_(ht,V,{handler:function(t){var e=lt[t.type],n=ut.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:I,srcEvent:t})}});function dt(){V.apply(this,arguments);var t=v(this.handler,this);this.touch=new ht(this.manager,t),this.mouse=new K(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ft(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,
pt.call(this,e)):12&t&&pt.call(this,e)}function pt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),2500)}}function gt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var o=this.lastTouches[i],r=Math.abs(e-o.x),s=Math.abs(n-o.y);if(r<=25&&s<=25)return!0}return!1}_(dt,V,{handler:function(t,e,n){var i=n.pointerType==I,o=n.pointerType==B;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)ft.call(this,e,n);else if(o&&gt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var mt=T(a.style,"touchAction"),_t=mt!==o,vt="compute",yt="auto",bt="manipulation",wt="none",Ct="pan-x",xt="pan-y",St=function(){if(!_t)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){
t[i]=!n||e.CSS.supports("touch-action",i)})),t}();function Et(t,e){this.manager=t,this.set(e)}Et.prototype={set:function(t){t==vt&&(t=this.compute()),_t&&this.manager.element.style&&St[t]&&(this.manager.element.style[mt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return f(this.manager.recognizers,(function(e){y(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(S(t,wt))return wt;var e=S(t,Ct),n=S(t,xt);if(e&&n)return wt;if(e||n)return e?Ct:xt;if(S(t,bt))return bt;return yt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,o=S(i,wt)&&!St.none,r=S(i,xt)&&!St["pan-y"],s=S(i,Ct)&&!St["pan-x"];if(o){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}if(!s||!r)return o||r&&6&n||s&&n&F?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,
t.preventDefault()}};var kt=32;function Nt(t){this.options=r({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=b(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function At(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Tt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Rt(t,e){var n=e.manager;return n?n.get(t):t}function Lt(){Nt.apply(this,arguments)}function Pt(){Lt.apply(this,arguments),this.pX=null,this.pY=null}function Mt(){Lt.apply(this,arguments)}function Ot(){Nt.apply(this,arguments),this._timer=null,this._input=null}function It(){Lt.apply(this,arguments)}function Bt(){Lt.apply(this,arguments)}function Ft(){Nt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ht(t,e){return(e=e||{}).recognizers=b(e.recognizers,Ht.defaults.preset),new Dt(t,e)}Nt.prototype={defaults:{},set:function(t){return r(this.options,t),
this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Rt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)||(t=Rt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return-1===k(e,t=Rt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=Rt(t,this);var e=k(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<8&&i(e.options.event+At(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=8&&i(e.options.event+At(n))},tryEmit:function(t){
if(this.canEmit())return this.emit(t);this.state=kt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=r({},t);if(!y(this.options.enable,[this,e]))return this.reset(),void(this.state=kt);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},_(Lt,Nt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,o=this.attrTest(t);return i&&(8&n||!o)?16|e:i||o?4&n?8|e:2&e?4|e:2:kt}}),_(Pt,Lt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(xt),t&F&&e.push(Ct),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,
n=r!=this.pX,i=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=o,n&&i>e.threshold&&o&e.direction},attrTest:function(t){return Lt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Tt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),_(Mt,Lt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),_(Ot,Nt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[yt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,
!i||!n||12&t.eventType&&!o)this.reset();else if(1&t.eventType)this.reset(),this._timer=u((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return kt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}}),_(It,Lt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),_(Bt,Lt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Pt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&F&&(e=t.overallVelocityY),
this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&c(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Tt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),_(Ft,Nt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[bt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(i&&o&&n){if(4!=t.eventType)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||j(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&r?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=u((function(){this.state=8,this.tryEmit()}),e.interval,this),
2):8}return kt},failTimeout:function(){return this._timer=u((function(){this.state=kt}),this.options.interval,this),kt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ht.VERSION="2.0.7",Ht.defaults={domEvents:!1,touchAction:vt,enable:!0,inputTarget:null,inputClass:null,preset:[[It,{enable:!1}],[Mt,{enable:!1},["rotate"]],[Bt,{direction:6}],[Pt,{direction:6},["swipe"]],[Ft],[Ft,{event:"doubletap",taps:2},["tap"]],[Ot]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Dt(t,e){var n;this.options=r({},Ht.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(M?nt:O?ht:P?dt:K))(n,q),this.touchAction=new Et(this,this.options.touchAction),Vt(this,!0),
f(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Vt(t,e){var n,i=t.element;i.style&&(f(t.options.cssProps,(function(o,r){n=T(i.style,r),e?(t.oldCssProps[n]=i.style[n],i.style[n]=o):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Dt.prototype={set:function(t){return r(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(o=e.curRecognizer=null);for(var r=0;r<i.length;)n=i[r],2===e.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(t),!o&&14&n.state&&(o=e.curRecognizer=n),r++}},get:function(t){if(t instanceof Nt)return t
;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=k(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==o&&e!==o){var n=this.handlers;return f(E(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==o){var n=this.handlers;return f(E(t),(function(t){e?n[t]&&n[t].splice(k(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var i=n.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var o=0;o<i.length;)i[o](e),o++}},destroy:function(){
this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r(Ht,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:kt,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:F,DIRECTION_ALL:30,Manager:Dt,Input:V,TouchAction:Et,TouchInput:ht,MouseInput:K,PointerEventInput:nt,TouchMouseInput:dt,SingleTouchInput:st,Recognizer:Nt,AttrRecognizer:Lt,Tap:Ft,Pan:Pt,Swipe:Bt,Pinch:Mt,Rotate:It,Press:Ot,on:w,off:C,each:f,merge:m,extend:g,assign:r,inherit:_,bindFn:v,prefixed:T}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Ht,t.exports?t.exports=Ht:e.Hammer=Ht}(window,document)}(mo);function _o({children:t}){return ct("ul",{className:c("absolute w-[23px] left-[-22px] h-full","bg-grey-2 sidebar-collapsed:bg-black/[.08]","pointer-events-none"),children:t})}
function vo({children:t,topPosition:e}){return ct("li",{className:c("absolute right-0","pointer-events-auto"),style:{top:e},children:t})}function yo({above:t,below:e,buckets:n,onFocusAnnotations:i,onScrollToClosestOffScreenAnchor:o,onSelectAnnotations:r}){const s=t.tags.size>0,a=e.tags.size>0;return ct(_o,{children:[s&&ct(vo,{topPosition:t.position,children:ct(mt,{className:c("BucketButton UpBucketButton","right-0 mt-[-11px]"),"data-testid":"up-navigation-button",onClick:()=>o([...t.tags],"up"),onBlur:()=>i([]),onFocus:()=>i([...t.tags]),onMouseEnter:()=>i([...t.tags]),onMouseOut:()=>i([]),title:`Go up to next annotations (${t.tags.size})`,children:t.tags.size})}),n.map(((t,e)=>ct(vo,{topPosition:t.position,children:ct(mt,{className:c("BucketButton LeftBucketButton","right-0 mt-[-8px]"),onClick:e=>r([...t.tags],e.metaKey||e.ctrlKey),onBlur:()=>i([]),onFocus:()=>i([...t.tags]),onMouseEnter:()=>i([...t.tags]),onMouseOut:()=>i([]),title:`Select nearby annotations (${t.tags.size})`,children:t.tags.size})
},e))),a&&ct(vo,{topPosition:e.position,children:ct(mt,{className:"BucketButton DownBucketButton right-0","data-testid":"down-navigation-button",onClick:()=>o([...e.tags],"down"),onBlur:()=>i([]),onFocus:()=>i([...e.tags]),onMouseEnter:()=>i([...e.tags]),onMouseOut:()=>i([]),title:`Go up to next annotations (${e.tags.size})`,children:e.tags.size})})]})}class bo{constructor(t,{onFocusAnnotations:e,onScrollToClosestOffScreenAnchor:n,onSelectAnnotations:i}){this._bucketsContainer=document.createElement("div"),t.appendChild(this._bucketsContainer),this._onFocusAnnotations=e,this._onScrollToClosestOffScreenAnchor=n,this._onSelectAnnotations=i,this.update([])}destroy(){I(null,this._bucketsContainer),this._bucketsContainer.remove()}update(t){const e=function(t){const e=new Set,n=new Set,i=[];let o=null;function r({bottom:t,tag:e,top:n}){return{bottom:t,position:n+(t-n)/2,tags:new Set([e]),top:n}}return t.forEach((t=>{if(t.top<137)return void e.add(t.tag);if(t.top>window.innerHeight-22)return void n.add(t.tag)
;if(!o)return void(o=r(t));const s=t.top>o.top&&t.bottom<o.bottom;if(t.top-o.bottom>60&&!s)i.push(o),o=r(t);else{const e=t.bottom>o.bottom?t.bottom:o.bottom,n=e-o.top;o.tags.add(t.tag),o.bottom=e,o.position=o.top+n/2}})),o&&i.push(o),{above:{tags:e,position:137},below:{tags:n,position:window.innerHeight-22},buckets:i}}(t);I(ct(yo,{above:e.above,below:e.below,buckets:e.buckets,onFocusAnnotations:t=>this._onFocusAnnotations(t),onScrollToClosestOffScreenAnchor:(t,e)=>this._onScrollToClosestOffScreenAnchor(t,e),onSelectAnnotations:(t,e)=>this._onSelectAnnotations(t,e)}),this._bucketsContainer)}}function wo({...t}){const{icon:e,title:n,...i}=t;return ct(gt,{className:c("w-[30px] h-[30px]","rounded-px","flex items-center justify-center","border bg-white text-grey-6 hover:text-grey-9","shadow transition-colors"),icon:e,title:n,...i})}function Co({highlightsVisible:t}){return ct("div",{className:"sr-only",role:"status","data-testid":"toolbar-status",children:t?"Highlights visible":"Highlights hidden"})}
function xo({closeSidebar:t,createAnnotation:e,isSidebarOpen:n,newAnnotationType:i,showHighlights:o,toggleHighlights:r,toggleSidebar:s,toggleSidebarRef:a,useMinimalControls:l=!1}){return ct("div",{className:c("absolute left-[-33px] w-[33px] z-2","text-px-base leading-none"),children:[l&&n&&ct(gt,{className:c("w-[27px] h-[27px] mt-[140px] ml-px-1.5","flex items-center justify-center bg-white border","text-grey-6 hover:text-grey-9 transition-colors","border-r-0","shadow-sidebar"),title:"Close annotation sidebar",icon:"cancel",onClick:t}),!l&&ct(m,{children:[ct(gt,{className:c("h-[40px] w-[33px] pl-px-1.5","bg-white text-grey-5 hover:text-grey-9","border-l border-b"),buttonRef:a,title:"Annotation sidebar",icon:n?"caret-right":"caret-left",expanded:n,pressed:n,onClick:s}),ct("div",{className:"space-y-px-1.5 mt-px-2",children:[ct(wo,{title:"Show highlights",icon:o?"show":"hide",selected:o,onClick:r}),ct(wo,{title:"note"===i?"New page note":"New annotation",icon:"note"===i?"note":"annotate",onClick:e})]}),ct(Co,{
highlightsVisible:o})]})]})}class So{constructor(t,e){const{createAnnotation:n,setSidebarOpen:i,setHighlightsVisible:o}=e;this._container=t,this._useMinimalControls=!1,this._newAnnotationType="note",this._highlightsVisible=!1,this._sidebarOpen=!1,this._closeSidebar=()=>i(!1),this._toggleSidebar=()=>i(!this._sidebarOpen),this._toggleHighlights=()=>o(!this._highlightsVisible),this._createAnnotation=()=>{n(),i(!0)},this._sidebarToggleButton={current:null},this.render()}getWidth(){return this._container.firstChild.getBoundingClientRect().width}set useMinimalControls(t){this._useMinimalControls=t,this.render()}get useMinimalControls(){return this._useMinimalControls}set sidebarOpen(t){this._sidebarOpen=t,this.render()}get sidebarOpen(){return this._sidebarOpen}set newAnnotationType(t){this._newAnnotationType=t,this.render()}get newAnnotationType(){return this._newAnnotationType}set highlightsVisible(t){this._highlightsVisible=t,this.render()}get highlightsVisible(){return this._highlightsVisible}
get sidebarToggleButton(){return this._sidebarToggleButton.current}render(){I(ct(xo,{closeSidebar:this._closeSidebar,createAnnotation:this._createAnnotation,newAnnotationType:this._newAnnotationType,isSidebarOpen:this._sidebarOpen,showHighlights:this._highlightsVisible,toggleHighlights:this._toggleHighlights,toggleSidebar:this._toggleSidebar,toggleSidebarRef:this._sidebarToggleButton,useMinimalControls:this.useMinimalControls}),this._container)}}const Eo=280;class ko{constructor(t,e,n){if(this._emitter=e.createEmitter(),this._guestWithSelection=null,this._guestRPC=[],this._sidebarRPC=new Vt,this.iframe=function(t){const e=t.sidebarAppUrl,n=ho(e,uo(e,t)),i=document.createElement("iframe");return i.setAttribute("allowfullscreen",""),i.src=n,i.title="Hypothesis annotation viewer",i.className="sidebar-frame",i}(n),this._config=n,this.bucketBar=null,this.features=new on,n.externalContainerSelector){var i;this.externalFrame=null!==(i=document.querySelector(n.externalContainerSelector))&&void 0!==i?i:t,
this.externalFrame.appendChild(this.iframe)}else{this.iframeContainer=document.createElement("div"),this.iframeContainer.style.display="none",this.iframeContainer.className="sidebar-container","clean"===n.theme?this.iframeContainer.classList.add("theme-clean"):this.bucketBar=new bo(this.iframeContainer,{onFocusAnnotations:t=>this._guestRPC.forEach((e=>e.call("hoverAnnotations",t))),onScrollToClosestOffScreenAnchor:(t,e)=>this._guestRPC.forEach((n=>n.call("scrollToClosestOffScreenAnchor",t,e))),onSelectAnnotations:(t,e)=>this._guestRPC.forEach((n=>n.call("selectAnnotations",t,e)))}),this.iframeContainer.appendChild(this.iframe),this.hypothesisSidebar=document.createElement("hypothesis-sidebar");Ae(this.hypothesisSidebar).appendChild(this.iframeContainer),t.appendChild(this.hypothesisSidebar)}this.iframe.contentWindow&&Ot(this.iframe.contentWindow),this._listeners=new Ct;const o=document.createElement("div");this.toolbar=new So(o,{createAnnotation:()=>{var t;if(0===this._guestRPC.length)return
;(null!==(t=this._guestWithSelection)&&void 0!==t?t:this._guestRPC[0]).call("createAnnotation")},setSidebarOpen:t=>t?this.open():this.close(),setHighlightsVisible:t=>this.setHighlightsVisible(t)}),"clean"===n.theme?this.toolbar.useMinimalControls=!0:this.toolbar.useMinimalControls=!1,this.iframeContainer?(this.iframeContainer.prepend(o),this.toolbarWidth=this.toolbar.getWidth()):this.toolbarWidth=0,this._listeners.add(window,"resize",(()=>this._onResize())),this._gestureState={initial:null,final:null},this._setupGestures(),this.close();const[r]=n.services||[];r&&(this.onLoginRequest=r.onLoginRequest,this.onLogoutRequest=r.onLogoutRequest,this.onSignupRequest=r.onSignupRequest,this.onProfileRequest=r.onProfileRequest,this.onHelpRequest=r.onHelpRequest),this.onLayoutChange=n.onLayoutChange,this._layoutState={expanded:!1,width:0,toolbarWidth:0},this._updateLayoutState(!1),this._setupSidebarEvents()}destroy(){var t,e;this._guestRPC.forEach((t=>t.destroy())),this._sidebarRPC.destroy(),
null===(t=this.bucketBar)||void 0===t||t.destroy(),this._listeners.removeAll(),null===(e=this._hammerManager)||void 0===e||e.destroy(),this.hypothesisSidebar?this.hypothesisSidebar.remove():this.iframe.remove(),this._emitter.destroy(),Ot(null)}onFrameConnected(t,e){switch(t){case"guest":this._connectGuest(e);break;case"sidebar":this._sidebarRPC.connect(e)}}_connectGuest(t){const e=new Vt;e.on("textSelected",(()=>{this._guestWithSelection=e,this.toolbar.newAnnotationType="annotation",this._guestRPC.filter((t=>t!==e)).forEach((t=>t.call("clearSelection")))})),e.on("textUnselected",(()=>{this._guestWithSelection=null,this.toolbar.newAnnotationType="note",this._guestRPC.filter((t=>t!==e)).forEach((t=>t.call("clearSelection")))})),e.on("highlightsVisibleChanged",(t=>{this.setHighlightsVisible(t)}));const n=this.bucketBar;n&&e.on("anchorsChanged",(t=>{0===this._guestRPC.indexOf(e)&&n.update(t)})),e.on("close",(()=>{e.destroy(),e===this._guestWithSelection&&(this._guestWithSelection=null),
this._guestRPC=this._guestRPC.filter((t=>t!==e))})),e.connect(t),this._guestRPC.push(e),e.call("sidebarLayoutChanged",this._layoutState)}_setupSidebarEvents(){var t;t=document.body,this._sidebarRPC.on("publicAnnotationCountChanged",(function(e){const n=t.querySelectorAll("[data-hypothesis-annotation-count]");Array.from(n).forEach((t=>{t.textContent=e.toString()}))})),function(t,e){const n=t.querySelectorAll("[data-hypothesis-trigger]");Array.from(n).forEach((t=>{t.addEventListener("click",(t=>{e(),t.stopPropagation()}))}))}(document.body,(()=>this.open())),this._sidebarRPC.on("featureFlagsUpdated",(t=>this.features.update(t))),this._sidebarRPC.on("connect",(()=>{this.iframeContainer&&(this.iframeContainer.style.display="");const t="always"===this._config.showHighlights;this.setHighlightsVisible(t),(this._config.openSidebar||this._config.annotations||this._config.query||this._config.group)&&this.open()})),this._sidebarRPC.on("showHighlights",(()=>this.setHighlightsVisible(!0))),
this._sidebarRPC.on("openSidebar",(()=>this.open())),this._sidebarRPC.on("closeSidebar",(()=>this.close())),this._sidebarRPC.on("openNotebook",(t=>{this.hide(),this._emitter.publish("openNotebook",t)})),this._emitter.subscribe("closeNotebook",(()=>{this.show()}));[["loginRequested",this.onLoginRequest],["logoutRequested",this.onLogoutRequest],["signupRequested",this.onSignupRequest],["profileRequested",this.onProfileRequest],["helpRequested",this.onHelpRequest]].forEach((([t,e])=>{e&&this._sidebarRPC.on(t,(()=>e()))}))}_resetGestureState(){this._gestureState={initial:null,final:null}}_setupGestures(){const t=this.toolbar.sidebarToggleButton;t&&(this._hammerManager=new mo.exports.Manager(t),this._hammerManager.on("panstart panend panleft panright",(t=>this._onPan(t))),this._hammerManager.add(new mo.exports.Pan({direction:mo.exports.DIRECTION_HORIZONTAL})))}_updateLayout(){this.renderFrame||(this.renderFrame=requestAnimationFrame((()=>{if(this.renderFrame=null,
this._gestureState.final!==this._gestureState.initial&&this.iframeContainer){const t=this._gestureState.final,e=-t;this.iframeContainer.style.marginLeft=`${t}px`,e>=Eo&&(this.iframeContainer.style.width=`${e}px`),this._updateLayoutState()}})))}_updateLayoutState(t){var e;const n=this.iframeContainer&&this.toolbar.getWidth()||0,i=null!==(e=this.iframeContainer)&&void 0!==e?e:this.externalFrame,o=i.getBoundingClientRect(),r=window.getComputedStyle(i),s=parseInt(r.width),a=parseInt(r.marginLeft);let l=n;"boolean"==typeof t?t&&(l+=s):(a<Eo?l-=a:l+=s,t=l>n);const c={expanded:t,width:t?l:n,height:o.height,toolbarWidth:n};this._layoutState=c,this.onLayoutChange&&this.onLayoutChange(c),this._guestRPC.forEach((t=>t.call("sidebarLayoutChanged",c)))}_onResize(){!0===this.toolbar.sidebarOpen&&(window.innerWidth<Eo?this.close():this.open())}_onPan(t){const e=this.iframeContainer;if(e)switch(t.type){case"panstart":this._resetGestureState(),e.classList.add("sidebar-no-transition"),e.style.pointerEvents="none",
this._gestureState.initial=parseInt(getComputedStyle(e).marginLeft);break;case"panend":e.classList.remove("sidebar-no-transition"),e.style.pointerEvents="",null===this._gestureState.final||this._gestureState.final<=-280?this.open():this.close(),this._resetGestureState();break;case"panleft":case"panright":{if("number"!=typeof this._gestureState.initial)return;const e=this._gestureState.initial,n=t.deltaX;this._gestureState.final=Math.min(Math.round(e+n),0),this._updateLayout();break}}}open(){if(this._sidebarRPC.call("sidebarOpened"),this.iframeContainer){const t=this.iframeContainer.getBoundingClientRect().width;this.iframeContainer.style.marginLeft=-1*t+"px",this.iframeContainer.classList.remove("sidebar-collapsed")}this.toolbar.sidebarOpen=!0,"whenSidebarOpen"===this._config.showHighlights&&this.setHighlightsVisible(!0),this._updateLayoutState(!0)}close(){this.iframeContainer&&(this.iframeContainer.style.marginLeft="",this.iframeContainer.classList.add("sidebar-collapsed")),this.toolbar.sidebarOpen=!1,
"whenSidebarOpen"===this._config.showHighlights&&this.setHighlightsVisible(!1),this._updateLayoutState(!1)}setHighlightsVisible(t){this.toolbar.highlightsVisible=t,this._sidebarRPC.call("setHighlightsVisible",t)}show(){this.iframeContainer&&this.iframeContainer.classList.remove("is-hidden")}hide(){this.iframeContainer&&this.iframeContainer.classList.add("is-hidden")}}class No{constructor(t){this._emitter=t,this._subscriptions=[]}publish(t,...e){this._emitter.emit(t,...e)}subscribe(t,e){this._emitter.on(t,e),this._subscriptions.push([t,e])}unsubscribe(t,e){this._emitter.off(t,e),this._subscriptions=this._subscriptions.filter((([n,i])=>n!==t||i!==e))}destroy(){for(let[t,e]of this._subscriptions)this._emitter.off(t,e);this._subscriptions=[]}}class Ao{constructor(){this._emitter=new Rt}createEmitter(){return new No(this._emitter)}}!function(t,{reset:e=!1}={}){e&&ht.clear();for(let[e,n]of Object.entries(t))ht.set(e,n)}(bt);const To=document.querySelector('link[type="application/annotator+html"][rel="sidebar"]')
;new Promise((t=>{"loading"!==document.readyState&&t(),document.addEventListener("readystatechange",(()=>t()))})).then((function(){const t=Zt("annotator"),e=t.subFrameIdentifier?window.parent:window,n=[];if(e===window){const t=function(t=navigator.userAgent){if(!Dt(t))return()=>{};const e=t=>{var e;if("hypothesisPortClosed"===(null===(e=t.data)||void 0===e?void 0:e.type)&&t.ports[0]){const e=t.ports[0];Ht(e,"close"),e.close()}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)}();n.push({destroy:t});const e=Zt("sidebar"),i=new URL(e.sidebarAppUrl).origin,o=new It(i),r=new Ao,s=new ko(document.body,r,e),a=new go(document.body,r,Zt("notebook"));o.on("frameConnected",((t,e)=>s.onFrameConnected(t,e))),n.push(o,s,a)}if("container"===Qi()){const e=new Ji(t);n.push(e)}else{const i=new Zi(document.body,t),o=new co(document.body,t,e);n.push(i,o)}To.addEventListener("destroy",(()=>{n.forEach((t=>t.destroy()))
;document.querySelectorAll("[data-hypothesis-asset]").forEach((t=>t.remove()))}))}))}();
//# sourceMappingURL=annotator.bundle.js.map
